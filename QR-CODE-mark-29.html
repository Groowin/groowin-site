<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û“õ—É—à—ã –†–∞—Å—Ç–∞—É –ñ“Ø–π–µ—Å—ñ</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            margin-top: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        .header {
            text-align: center;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .nav-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            cursor: pointer;
            background: transparent;
            border: none;
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .nav-tab:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .nav-tab.active {
            background: rgba(255, 255, 255, 0.2);
            border-bottom-color: #ffd700;
        }
        
        .tab-content {
            padding: 30px;
            min-height: 500px;
        }
        
        .tab-pane {
            display: none;
        }
        
        .tab-pane.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            box-sizing: border-box;
        }
        
        .btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }
        
        .students-list {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }
        
        .student-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .qr-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .qr-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .timer {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            margin-bottom: 20px;
        }
        
        .status {
            font-size: 1.2rem;
            margin: 15px 0;
            padding: 10px 20px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.2);
            text-align: center;
        }
        
        .students-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .student-card {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .student-card:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .student-card.verified {
            background: rgba(0, 255, 0, 0.3);
            border-color: #00ff00;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(0, 255, 0, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(0, 255, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 255, 0, 0); }
        }
        
        .location-link {
            color: #ffd700;
            text-decoration: none;
            font-weight: 600;
            display: inline-block;
            margin-top: 5px;
        }
        
        .location-link:hover {
            text-decoration: underline;
        }
        
        .geolocation-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .geolocation-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .geolocation-time {
            opacity: 0.8;
            margin-bottom: 10px;
        }
        
        .saved-classes-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .class-card {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }
        
        .class-card:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .class-card.active {
            background: rgba(0, 255, 0, 0.3);
            border-color: #00ff00;
        }
        
        .class-card-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .class-card-count {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .class-card-delete {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(255, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .title {
                font-size: 2rem;
            }
            
            .nav-tab {
                font-size: 0.9rem;
                padding: 12px 10px;
            }
            
            .students-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .tab-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">üéì –û“õ—É—à—ã –†–∞—Å—Ç–∞—É –ñ“Ø–π–µ—Å—ñ</h1>
            <p class="subtitle">–°—ã–Ω—ã–ø –æ“õ—É—à—ã–ª–∞—Ä—ã–Ω –±–∞—Å“õ–∞—Ä—É –∂”ô–Ω–µ QR –∞—Ä“õ—ã–ª—ã —Ä–∞—Å—Ç–∞—É</p>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('students')">üìù –¢“Ø–≥–µ–ª–¥–µ—É</button>
            <button class="nav-tab" onclick="showTab('qr')">üì± QR</button>
            <button class="nav-tab" onclick="showTab('geolocation')">üåç –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è</button>
        </div>
        
        <div class="tab-content">
            <!-- –¢“Ø–≥–µ–ª–¥–µ—É –±”©–ª—ñ–º—ñ -->
            <div id="studentsTab" class="tab-pane active">
                <h2>–û“õ—É—à—ã–ª–∞—Ä–¥—ã –±–∞—Å“õ–∞—Ä—É</h2>
                
                <div class="form-group">
                    <label class="form-label" for="className">–°—ã–Ω—ã–ø –∞—Ç–∞—É—ã:</label>
                    <input type="text" id="className" class="form-input" placeholder="–°—ã–Ω—ã–ø –∞—Ç–∞—É—ã–Ω –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑">
                </div>
                
                <div class="form-group">
                    <label class="form-label">–°–∞“õ—Ç–∞–ª“ì–∞–Ω —Å—ã–Ω—ã–ø—Ç–∞—Ä:</label>
                    <div id="savedClassesList" class="saved-classes-grid">
                        <!-- –°–∞“õ—Ç–∞–ª“ì–∞–Ω —Å—ã–Ω—ã–ø—Ç–∞—Ä –æ—Å—ã–Ω–¥–∞ –∫”©—Ä—Å–µ—Ç—ñ–ª–µ–¥—ñ -->
                    </div>
                </div>
                

                
                <div class="form-group">
                    <label class="form-label" for="studentsText">–û“õ—É—à—ã –∞—Ç—ã-–∂”©–Ω—ñ:</label>
                    <textarea id="studentsText" class="form-input" rows="6" placeholder="”ò—Ä –∂–æ–ª“ì–∞ –±—ñ—Ä –æ“õ—É—à—ã –∞—Ç—ã–Ω –∂–∞–∑—ã“£—ã–∑:&#10;–ê–π–¥–∞—Ä –°–µ—Ä—ñ–∫“±–ª—ã&#10;–ê–º–∏–Ω–∞ –ë–µ–∫“õ—ã–∑—ã&#10;–î”ô—É—Ä–µ–Ω –ú“±—Ä–∞—Ç“±–ª—ã"></textarea>
                </div>
                
                <button class="btn" onclick="addMultipleStudents()">‚ûï –û“õ—É—à—ã “õ–æ—Å—É</button>
                <button class="btn" onclick="saveClass()">üíæ –°—ã–Ω—ã–ø—Ç—ã —Å–∞“õ—Ç–∞—É</button>
                <button class="btn btn-danger" onclick="clearAllStudents()">üóëÔ∏è –ë–∞—Ä–ª—ã“ì—ã–Ω ”©—à—ñ—Ä—É</button>
                
                <div class="students-list">
                    <h3>–°—ã–Ω—ã–ø —Ç—ñ–∑—ñ–º—ñ: <span id="currentClassName">–°—ã–Ω—ã–ø —Ç–∞“£–¥–∞–ª–º–∞“ì–∞–Ω</span></h3>
                    <div id="studentsList">
                        <p style="opacity: 0.7;">”ò–ª—ñ –æ“õ—É—à—ã–ª–∞—Ä “õ–æ—Å—ã–ª–º–∞“ì–∞–Ω</p>
                    </div>
                </div>
            </div>
            
            <!-- QR –±”©–ª—ñ–º—ñ -->
            <div id="qrTab" class="tab-pane">
                <div class="qr-section">
                    <h2 style="text-align: center; margin-bottom: 20px; font-size: 2rem;">üì± QR –ö–æ–¥ –†–∞—Å—Ç–∞—É</h2>
                    
                    <div class="qr-container" id="qrContainer" style="
                        text-align: center;
                        margin: 0 auto 20px auto;
                    ">
                        <div id="qrCodeDisplay" style="margin: 20px 0;">
                            <!-- QR –∫–æ–¥ –æ—Å—ã–Ω–¥–∞ –∫”©—Ä—Å–µ—Ç—ñ–ª–µ–¥—ñ -->
                        </div>

                    </div>

                    <div class="timer" id="qrTimer" style="
                        text-align: center;
                        font-size: 1.8rem;
                        font-weight: bold;
                        color: #ffd700;
                        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
                        margin-bottom: 20px;
                        background: rgba(255, 215, 0, 0.2);
                        padding: 15px;
                        border-radius: 15px;
                        border: 2px solid #ffd700;
                    ">
                        QR –∫–æ–¥ –∂–∞—Ä–∞–º–¥—ã: 15 —Å–µ–∫—É–Ω–¥
                    </div>

                    <div class="status" id="status" style="
                        text-align: center;
                        font-size: 1.3rem;
                        margin: 20px 0;
                        padding: 15px 25px;
                        border-radius: 15px;
                        background: rgba(255, 255, 255, 0.2);
                        border: 2px solid rgba(255, 255, 255, 0.3);
                        font-weight: 600;
                    ">QR –∫–æ–¥—Ç—ã —Å–∫–∞–Ω–µ—Ä–ª–µ“£—ñ–∑</div>

                    <button onclick="generateQRCode()" style="
                        background: linear-gradient(45deg, #ff6b6b, #ee5a24);
                        color: white;
                        border: none;
                        padding: 15px 30px;
                        border-radius: 25px;
                        font-size: 1.2rem;
                        font-weight: 600;
                        cursor: pointer;
                        margin: 0 auto;
                        display: block;
                        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                        transition: all 0.3s ease;
                    " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                        üîÑ –ñ–∞“£–∞ QR –∫–æ–¥ –∂–∞—Å–∞—É
                    </button>
                </div>
                
                <div style="margin-top: 40px;">
                    <h3 style="text-align: center; font-size: 1.8rem; margin-bottom: 25px; color: #ffd700;">
                        üë• –°—ã–Ω—ã–ø –æ“õ—É—à—ã–ª–∞—Ä—ã
                    </h3>
                    <div class="students-grid" id="studentsGrid">
                        <!-- –û“õ—É—à—ã–ª–∞—Ä –æ—Å—ã–Ω–¥–∞ –∫”©—Ä—Å–µ—Ç—ñ–ª–µ–¥—ñ -->
                    </div>
                </div>
            </div>
            
            <!-- –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –±”©–ª—ñ–º—ñ -->
            <div id="geolocationTab" class="tab-pane">
                <h2>–†–∞—Å—Ç–∞–ª“ì–∞–Ω –æ“õ—É—à—ã–ª–∞—Ä–¥—ã“£ –æ—Ä–Ω–∞–ª–∞—Å—É—ã</h2>
                <div id="geolocationList">
                    <p style="opacity: 0.7;">”ò–ª—ñ –µ—à–∫—ñ–º —Ä–∞—Å—Ç–∞–ª–º–∞“ì–∞–Ω</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentQRCode = '';
        let qrValidUntil = 0;
        let countdownInterval;
        let verifiedUsers = [];
        let students = [];
        let currentClassName = '';
        let savedClasses = {};
        
        // –ë”©–ª—ñ–º–¥–µ—Ä–¥—ñ –∞—É—ã—Å—Ç—ã—Ä—É
        function showTab(tabName) {
            // –ë–∞—Ä–ª—ã“õ —Ç–∞–±—Ç–∞—Ä–¥—ã –∂–∞—Å—ã—Ä—É
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.remove('active');
            });
            
            // –ë–∞—Ä–ª—ã“õ –Ω–∞–≤–∏–≥–∞—Ü–∏—è –±–∞—Ç—ã—Ä–º–∞–ª–∞—Ä—ã–Ω –¥–µ–∑–∞–∫—Ç–∏–≤—Ç–µ—É
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –¢–∞“£–¥–∞–ª“ì–∞–Ω —Ç–∞–±—Ç—ã –∫”©—Ä—Å–µ—Ç—É
            document.getElementById(tabName + 'Tab').classList.add('active');
            event.target.classList.add('active');
            
            // QR –±”©–ª—ñ–º—ñ–Ω–µ ”©—Ç–∫–µ–Ω–¥–µ QR –∫–æ–¥—Ç—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏—è–ª–∞—É
            if (tabName === 'qr') {
                generateQRCode();
                updateStudentsGrid();
            }
        }
        
        // –û“õ—É—à—ã “õ–æ—Å—É
        function addStudent() {
            const studentName = document.getElementById('studentName').value.trim();
            
            if (!studentName) {
                alert('–û“õ—É—à—ã –∞—Ç—ã–Ω –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑!');
                return;
            }
            
            // “ö–∞–π—Ç–∞–ª–∞–Ω–±–∞—É—ã–Ω —Ç–µ–∫—Å–µ—Ä—É
            if (students.find(s => s.name === studentName)) {
                alert('–ë“±–ª –æ“õ—É—à—ã “õ–∞–∑—ñ—Ä–¥—ñ“£ ”©–∑—ñ–Ω–¥–µ —Ç—ñ–∑—ñ–º–¥–µ –±–∞—Ä!');
                return;
            }
            
            const student = {
                id: Date.now(),
                name: studentName,
                verified: false,
                verificationTime: null,
                location: null
            };
            
            students.push(student);
            document.getElementById('studentName').value = '';
            updateStudentsList();
            updateStudentsGrid();
        }
        
        // –ë—ñ—Ä–Ω–µ—à–µ –æ“õ—É—à—ã “õ–æ—Å—É
        function addMultipleStudents() {
            const studentsText = document.getElementById('studentsText').value.trim();
            
            if (!studentsText) {
                alert('–û“õ—É—à—ã–ª–∞—Ä —Ç—ñ–∑—ñ–º—ñ–Ω –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑!');
                return;
            }
            
            // –ñ–æ–ª–¥–∞—Ä“ì–∞ –±”©–ª—É (–∂–∞“£–∞ –∂–æ–ª, “Ø—Ç—ñ—Ä, –Ω“Ø–∫—Ç–µ-“Ø—Ç—ñ—Ä –∞—Ä“õ—ã–ª—ã)
            let lines = studentsText.split(/[\n,;]+/);
            let addedCount = 0;
            let duplicateCount = 0;
            
            lines.forEach(line => {
                // –ê—Ä—Ç—ã“õ –±–æ—Å –æ—Ä—ã–Ω–¥–∞—Ä–¥—ã, —Ç–∞–±—É–ª—è—Ü–∏—è–ª–∞—Ä–¥—ã, –∞—Ä–Ω–∞–π—ã —Å–∏–º–≤–æ–ª–¥–∞—Ä–¥—ã –∞–ª—ã–ø —Ç–∞—Å—Ç–∞—É
                let studentName = line
                    .replace(/[\t\r\n]+/g, ' ')  // –¢–∞–±—É–ª—è—Ü–∏—è –∂”ô–Ω–µ –∂–∞“£–∞ –∂–æ–ª–¥–∞—Ä–¥—ã –±–æ—Å –æ—Ä—ã–Ω“ì–∞ –∞—É—ã—Å—Ç—ã—Ä—É
                    .replace(/\s+/g, ' ')        // –ë—ñ—Ä–Ω–µ—à–µ –±–æ—Å –æ—Ä—ã–Ω–¥–∞—Ä–¥—ã –±—ñ—Ä–µ—É–≥–µ –∞—É—ã—Å—Ç—ã—Ä—É
                    .replace(/[^\u0400-\u04FF\u0500-\u052F\w\s\-']/g, '') // –¢–µ–∫ “õ–∞–∑–∞“õ, –æ—Ä—ã—Å ”ô—Ä—ñ–ø—Ç–µ—Ä—ñ, —Å–∞–Ω–¥–∞—Ä, –¥–µ—Ñ–∏—Å, –∞–ø–æ—Å—Ç—Ä–æ—Ñ
                    .trim();
                
                // –ë–æ—Å –∂–æ–ª–¥–∞—Ä–¥—ã –∂”ô–Ω–µ —Ç—ã–º “õ—ã—Å“õ–∞ –∞—Ç–∞—É–ª–∞—Ä–¥—ã ”©—Ç–∫—ñ–∑—É
                if (!studentName || studentName.length < 2) return;
                
                // –ë—ñ—Ä—ñ–Ω—à—ñ ”ô—Ä—ñ–ø—Ç—ñ “Ø–ª–∫–µ–Ω –µ—Ç—ñ–ø –∂–∞—Å–∞—É
                studentName = studentName.split(' ')
                    .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
                    .join(' ');
                
                // “ö–∞–π—Ç–∞–ª–∞–Ω–±–∞—É—ã–Ω —Ç–µ–∫—Å–µ—Ä—É
                if (students.find(s => s.name === studentName)) {
                    duplicateCount++;
                    return;
                }
                
                const student = {
                    id: Date.now() + Math.random(), // –£–Ω–∏–∫–∞–ª–¥—ã ID
                    name: studentName,
                    verified: false,
                    verificationTime: null,
                    location: null
                };
                
                students.push(student);
                addedCount++;
            });
            
            // –ù”ô—Ç–∏–∂–µ–Ω—ñ –∫”©—Ä—Å–µ—Ç—É
            let message = `${addedCount} –æ“õ—É—à—ã “õ–æ—Å—ã–ª–¥—ã!`;
            if (duplicateCount > 0) {
                message += ` ${duplicateCount} –æ“õ—É—à—ã “õ–∞–π—Ç–∞–ª–∞–Ω“ì–∞–Ω–¥—ã“õ—Ç–∞–Ω ”©—Ç–∫—ñ–∑—ñ–ª–¥—ñ.`;
            }
            
            if (addedCount > 0) {
                alert(message);
                // Textarea-–Ω—ã —Ç–∞–∑–∞–ª–∞—É
                document.getElementById('studentsText').value = '';
                updateStudentsList();
                updateStudentsGrid();
            } else {
                alert('–ñ–∞—Ä–∞–º–¥—ã –æ“õ—É—à—ã –∞—Ç—Ç–∞—Ä—ã —Ç–∞–±—ã–ª–º–∞–¥—ã. –î“±—Ä—ã—Å —Ñ–æ—Ä–º–∞—Ç—Ç–∞ –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑.');
            }
        }
        
        // –û“õ—É—à—ã–Ω—ã ”©—à—ñ—Ä—É
        function removeStudent(studentId) {
            students = students.filter(s => s.id !== studentId);
            updateStudentsList();
            updateStudentsGrid();
            updateGeolocationList();
        }
        
        // –°—ã–Ω—ã–ø—Ç—ã —Å–∞“õ—Ç–∞—É
        function saveClass() {
            const className = document.getElementById('className').value.trim();
            if (!className) {
                alert('–°—ã–Ω—ã–ø –∞—Ç–∞—É—ã–Ω –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑!');
                return;
            }
            
            if (students.length === 0) {
                alert('–ê–ª–¥—ã–º–µ–Ω –æ“õ—É—à—ã–ª–∞—Ä–¥—ã “õ–æ—Å—ã“£—ã–∑!');
                return;
            }
            
            currentClassName = className;
            document.getElementById('currentClassName').textContent = className;
            
            // –°—ã–Ω—ã–ø—Ç—ã —Å–∞“õ—Ç–∞–ª“ì–∞–Ω —Å—ã–Ω—ã–ø—Ç–∞—Ä —Ç—ñ–∑—ñ–º—ñ–Ω–µ “õ–æ—Å—É
            savedClasses[className] = {
                students: [...students],
                createdAt: new Date().toLocaleString('kk-KZ')
            };
            
            // localStorage-“õ–∞ —Å–∞“õ—Ç–∞—É
            localStorage.setItem('savedClasses', JSON.stringify(savedClasses));
            localStorage.setItem('classData', JSON.stringify({
                className: currentClassName,
                students: students
            }));
            
            updateSavedClassesList();
            alert('–°—ã–Ω—ã–ø –¥–µ—Ä–µ–∫—Ç–µ—Ä—ñ —Å–∞“õ—Ç–∞–ª–¥—ã!');
        }
        
        // –°–∞“õ—Ç–∞–ª“ì–∞–Ω —Å—ã–Ω—ã–ø—Ç–∞—Ä —Ç—ñ–∑—ñ–º—ñ–Ω –∂–∞“£–∞—Ä—Ç—É
        function updateSavedClassesList() {
            const savedClassesList = document.getElementById('savedClassesList');
            
            if (Object.keys(savedClasses).length === 0) {
                savedClassesList.innerHTML = '<p style="opacity: 0.7; grid-column: 1 / -1; text-align: center;">”ò–ª—ñ —Å—ã–Ω—ã–ø—Ç–∞—Ä —Å–∞“õ—Ç–∞–ª–º–∞“ì–∞–Ω</p>';
                return;
            }
            
            const classesHTML = Object.keys(savedClasses).map(className => {
                const classData = savedClasses[className];
                const studentCount = classData.students.length;
                const isActive = className === currentClassName;
                
                return `
                    <div class="class-card ${isActive ? 'active' : ''}" onclick="loadClass('${className}')">
                        <div class="class-card-name">${className}</div>
                        <div class="class-card-count">${studentCount} –æ“õ—É—à—ã</div>
                        <button onclick="event.stopPropagation(); deleteClass('${className}')" style="
                            background: linear-gradient(45deg, #e74c3c, #c0392b);
                            color: white;
                            border: none;
                            padding: 5px 10px;
                            border-radius: 15px;
                            font-size: 0.8rem;
                            cursor: pointer;
                            margin-top: 8px;
                            transition: all 0.3s ease;
                        " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                            üóëÔ∏è ”®—à—ñ—Ä—É
                        </button>
                    </div>
                `;
            }).join('');
            
            savedClassesList.innerHTML = classesHTML;
        }
        
        // –°—ã–Ω—ã–ø—Ç—ã –∂“Ø–∫—Ç–µ—É
        function loadClass(className) {
            if (!savedClasses[className]) {
                alert('–°—ã–Ω—ã–ø —Ç–∞–±—ã–ª–º–∞–¥—ã!');
                return;
            }
            
            const classData = savedClasses[className];
            currentClassName = className;
            students = [...classData.students];
            
            // –†–∞—Å—Ç–∞—É —Å—Ç–∞—Ç—É—Å—ã–Ω “õ–∞–ª–ø—ã–Ω–∞ –∫–µ–ª—Ç—ñ—Ä—É
            students.forEach(student => {
                student.verified = false;
                student.verificationTime = null;
                student.location = null;
            });
            
            verifiedUsers = [];
            
            document.getElementById('className').value = className;
            document.getElementById('currentClassName').textContent = className;
            
            updateStudentsList();
            updateStudentsGrid();
            updateGeolocationList();
            updateSavedClassesList();
        }
        
        // –°—ã–Ω—ã–ø—Ç—ã ”©—à—ñ—Ä—É
        function deleteClass(className) {
            if (confirm(`"${className}" —Å—ã–Ω—ã–±—ã–Ω ”©—à—ñ—Ä—É–¥—ñ “õ–∞–ª–∞–π—Å—ã–∑ –±–∞?`)) {
                delete savedClasses[className];
                localStorage.setItem('savedClasses', JSON.stringify(savedClasses));
                updateSavedClassesList();
                
                // –ï–≥–µ—Ä –∞“ì—ã–º–¥–∞“ì—ã —Å—ã–Ω—ã–ø ”©—à—ñ—Ä—ñ–ª—Å–µ, —Ç–∞–∑–∞–ª–∞—É
                if (className === currentClassName) {
                    currentClassName = '';
                    students = [];
                    verifiedUsers = [];
                    document.getElementById('className').value = '';
                    document.getElementById('currentClassName').textContent = '–°—ã–Ω—ã–ø —Ç–∞“£–¥–∞–ª–º–∞“ì–∞–Ω';
                    updateStudentsList();
                    updateStudentsGrid();
                    updateGeolocationList();
                    
                    // localStorage-—Ç–∞–Ω –¥–∞ ”©—à—ñ—Ä—É
                    localStorage.removeItem('classData');
                }
                
                alert(`"${className}" —Å—ã–Ω—ã–±—ã —Å”ô—Ç—Ç—ñ ”©—à—ñ—Ä—ñ–ª–¥—ñ!`);
            }
        }
        
        // –ë–∞—Ä–ª—ã“õ –æ“õ—É—à—ã–ª–∞—Ä–¥—ã ”©—à—ñ—Ä—É
        function clearAllStudents() {
            if (confirm('–ë–∞—Ä–ª—ã“õ –æ“õ—É—à—ã–ª–∞—Ä–¥—ã, —Å—ã–Ω—ã–ø —Ç—ñ–∑—ñ–º—ñ–Ω –∂”ô–Ω–µ —Å–∞“õ—Ç–∞–ª“ì–∞–Ω —Å—ã–Ω—ã–ø—Ç–∞—Ä–¥—ã ”©—à—ñ—Ä—É–¥—ñ “õ–∞–ª–∞–π—Å—ã–∑ –±–∞?')) {
                // –ë–∞—Ä–ª—ã“õ –æ“õ—É—à—ã–ª–∞—Ä–¥—ã ”©—à—ñ—Ä—É
                students = [];
                verifiedUsers = [];
                
                // –ë–∞—Ä–ª—ã“õ —Å–∞“õ—Ç–∞–ª“ì–∞–Ω —Å—ã–Ω—ã–ø—Ç–∞—Ä–¥—ã ”©—à—ñ—Ä—É
                savedClasses = {};
                
                // –ê“ì—ã–º–¥–∞“ì—ã —Å—ã–Ω—ã–ø –∞—Ç–∞—É—ã–Ω “õ–∞–ª–ø—ã–Ω–∞ –∫–µ–ª—Ç—ñ—Ä—É
                currentClassName = '';
                document.getElementById('className').value = '';
                document.getElementById('currentClassName').textContent = '–°—ã–Ω—ã–ø —Ç–∞“£–¥–∞–ª–º–∞“ì–∞–Ω';
                
                // Textarea-–Ω—ã —Ç–∞–∑–∞–ª–∞—É
                document.getElementById('studentsText').value = '';
                
                // localStorage-—Ç–∞–Ω –±–∞—Ä–ª—ã“ì—ã–Ω ”©—à—ñ—Ä—É
                localStorage.removeItem('classData');
                localStorage.removeItem('savedClasses');
                localStorage.removeItem('newVerification');
                localStorage.removeItem('verificationTime');
                
                // –ë–∞—Ä–ª—ã“õ —Ç—ñ–∑—ñ–º–¥–µ—Ä–¥—ñ –∂–∞“£–∞—Ä—Ç—É
                updateStudentsList();
                updateStudentsGrid();
                updateGeolocationList();
                updateSavedClassesList();
                
                // QR —Å—Ç–∞—Ç—É—Å—ã–Ω “õ–∞–ª–ø—ã–Ω–∞ –∫–µ–ª—Ç—ñ—Ä—É
                const statusElement = document.getElementById('status');
                if (statusElement) {
                    statusElement.textContent = 'QR –∫–æ–¥—Ç—ã —Å–∫–∞–Ω–µ—Ä–ª–µ“£—ñ–∑';
                    statusElement.style.background = 'rgba(255, 255, 255, 0.2)';
                }
                
                alert('–ë–∞—Ä–ª—ã“õ –¥–µ—Ä–µ–∫—Ç–µ—Ä ”©—à—ñ—Ä—ñ–ª–¥—ñ!');
            }
        }
        
        // –û“õ—É—à—ã–ª–∞—Ä —Ç—ñ–∑—ñ–º—ñ–Ω –∂–∞“£–∞—Ä—Ç—É
        function updateStudentsList() {
            const studentsList = document.getElementById('studentsList');
            
            if (students.length === 0) {
                studentsList.innerHTML = '<p style="opacity: 0.7;">”ò–ª—ñ –æ“õ—É—à—ã–ª–∞—Ä “õ–æ—Å—ã–ª–º–∞“ì–∞–Ω</p>';
                return;
            }
            
            const studentsHTML = students.map(student => `
                <div class="student-item">
                    <div>
                        <strong>${student.name}</strong>
                        ${student.verified ? '<span style="color: #00ff00; margin-left: 10px;">‚úÖ –†–∞—Å—Ç–∞–ª“ì–∞–Ω</span>' : ''}
                    </div>
                    <button class="btn btn-danger" onclick="removeStudent(${student.id})">üóëÔ∏è ”®—à—ñ—Ä—É</button>
                </div>
            `).join('');
            
            studentsList.innerHTML = studentsHTML;
        }
        
        // QR –±”©–ª—ñ–º—ñ–Ω–¥–µ –æ“õ—É—à—ã–ª–∞—Ä —Ç–æ—Ä—ã–Ω –∂–∞“£–∞—Ä—Ç—É
        function updateStudentsGrid() {
            const studentsGrid = document.getElementById('studentsGrid');
            
            if (students.length === 0) {
                studentsGrid.innerHTML = '<p style="opacity: 0.7; grid-column: 1 / -1; text-align: center;">–ê–ª–¥—ã–º–µ–Ω "–¢“Ø–≥–µ–ª–¥–µ—É" –±”©–ª—ñ–º—ñ–Ω–¥–µ –æ“õ—É—à—ã–ª–∞—Ä–¥—ã “õ–æ—Å—ã“£—ã–∑</p>';
                return;
            }
            
            const studentsHTML = students.map(student => `
                <div class="student-card ${student.verified ? 'verified' : ''}" onclick="selectStudent(${student.id})">
                    <div style="font-weight: bold; margin-bottom: 5px;">${student.name}</div>
                    ${student.verified ? '<div style="color: #00ff00;">‚úÖ –†–∞—Å—Ç–∞–ª“ì–∞–Ω</div>' : '<div style="opacity: 0.7;">–†–∞—Å—Ç–∞—É–¥—ã –∫“Ø—Ç—É–¥–µ</div>'}
                </div>
            `).join('');
            
            studentsGrid.innerHTML = studentsHTML;
        }
        
        // –û“õ—É—à—ã–Ω—ã —Ç–∞“£–¥–∞—É (QR –∞—Ä“õ—ã–ª—ã —Ä–∞—Å—Ç–∞—É - —Ç–µ–∫ –∫”©—Ä—Å–µ—Ç—É “Ø—à—ñ–Ω)
        function selectStudent(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) return;
            
            if (student.verified) {
                alert(`${student.name} “õ–∞–∑—ñ—Ä–¥—ñ“£ ”©–∑—ñ–Ω–¥–µ —Ä–∞—Å—Ç–∞–ª“ì–∞–Ω!`);
                return;
            }
            
            alert('–†–∞—Å—Ç–∞—É “Ø—à—ñ–Ω —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–∞–Ω QR –∫–æ–¥—Ç—ã —Å–∫–∞–Ω–µ—Ä–ª–µ“£—ñ–∑!');
        }
        
        // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è —Ç—ñ–∑—ñ–º—ñ–Ω –∂–∞“£–∞—Ä—Ç—É
        function updateGeolocationList() {
            const geolocationList = document.getElementById('geolocationList');
            
            const verifiedStudents = students.filter(s => s.verified);
            
            if (verifiedStudents.length === 0) {
                geolocationList.innerHTML = '<p style="opacity: 0.7;">”ò–ª—ñ –µ—à–∫—ñ–º —Ä–∞—Å—Ç–∞–ª–º–∞“ì–∞–Ω</p>';
                return;
            }
            
            const geoHTML = verifiedStudents.map(student => {
                let locationHTML = '';
                if (student.location && student.location.lat && student.location.lng) {
                    const googleMapsUrl = `https://www.google.com/maps?q=${student.location.lat},${student.location.lng}`;
                    locationHTML = `
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-top: 10px;">
                            <span style="opacity: 0.8;">üìç –û—Ä–Ω–∞–ª–∞—Å—É—ã –∞–Ω—ã“õ—Ç–∞–ª–¥—ã</span>
                            <a href="${googleMapsUrl}" target="_blank" rel="noopener noreferrer" class="location-link" style="
                                background: linear-gradient(45deg, #ff6b6b, #ee5a24);
                                color: white;
                                padding: 8px 15px;
                                border-radius: 20px;
                                text-decoration: none;
                                font-size: 0.9rem;
                                font-weight: 600;
                                transition: all 0.3s ease;
                                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
                            " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                                üó∫Ô∏è –ö–∞—Ä—Ç–∞–¥–∞ –∫”©—Ä—É
                            </a>
                        </div>
                    `;
                } else {
                    locationHTML = '<div style="opacity: 0.7; margin-top: 10px;">üìç –û—Ä–Ω–∞–ª–∞—Å—É –∞–Ω—ã“õ—Ç–∞–ª–º–∞–¥—ã</div>';
                }
                
                return `
                    <div class="geolocation-item">
                        <div class="geolocation-name">${student.name}</div>
                        <div class="geolocation-time">–†–∞—Å—Ç–∞—É —É–∞“õ—ã—Ç—ã: ${student.verificationTime}</div>
                        ${locationHTML}
                    </div>
                `;
            }).join('');
            
            geolocationList.innerHTML = geoHTML;
        }
        
        // QR –∫–æ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è–ª–∞—É
        function generateQRCode() {
            const timestamp = Date.now();
            const randomId = Math.random().toString(36).substring(2, 15);
            currentQRCode = `VERIFY_${timestamp}_${randomId}`;
            qrValidUntil = timestamp + 15000; // 15 —Å–µ–∫—É–Ω–¥
            
            const qrCodeDisplay = document.getElementById('qrCodeDisplay');
            if (!qrCodeDisplay) return;
            
            // –ê“ì—ã–º–¥–∞“ì—ã —Å–∞–π—Ç—Ç—ã“£ URL-—ñ–Ω –ø–∞–π–¥–∞–ª–∞–Ω—É
            const currentUrl = window.location.href.split('?')[0];
            const verificationUrl = `${currentUrl}?verify=${currentQRCode}`;
            
            try {
                // QRCode.js –∫—ñ—Ç–∞–ø—Ö–∞–Ω–∞—Å—ã–Ω –ø–∞–π–¥–∞–ª–∞–Ω—É
                if (typeof QRCode !== 'undefined') {
                    // Canvas —ç–ª–µ–º–µ–Ω—Ç—ñ–Ω –∂–∞—Å–∞—É
                    const canvas = document.createElement('canvas');
                    
                    QRCode.toCanvas(canvas, verificationUrl, {
                        width: 280,
                        margin: 2,
                        color: {
                            dark: '#000000',
                            light: '#FFFFFF'
                        },
                        errorCorrectionLevel: 'H'
                    }, function (error) {
                        if (error) {
                            console.error('QR –∫–æ–¥ “õ–∞—Ç–µ—Å—ñ:', error);
                            showQRError();
                        } else {
                            // Canvas-—Ç—ã –∫”©—Ä—Å–µ—Ç—É
                            canvas.style.display = 'block';
                            canvas.style.margin = '0 auto';
                            canvas.style.border = '4px solid white';
                            canvas.style.borderRadius = '10px';
                            canvas.style.boxShadow = '0 4px 15px rgba(0, 0, 0, 0.2)';
                            
                            qrCodeDisplay.innerHTML = '';
                            qrCodeDisplay.appendChild(canvas);
                            
                            console.log('QR –∫–æ–¥ —Å”ô—Ç—Ç—ñ –∂–∞—Å–∞–ª–¥—ã:', verificationUrl);
                        }
                    });
                } else {
                    // –ö—ñ—Ç–∞–ø—Ö–∞–Ω–∞ –∂“Ø–∫—Ç–µ–ª–º–µ—Å–µ, “õ–∞—Ä–∞–ø–∞–π—ã–º QR –∫–æ–¥
                    console.log('QRCode –∫—ñ—Ç–∞–ø—Ö–∞–Ω–∞—Å—ã –∂“Ø–∫—Ç–µ–ª–º–µ–¥—ñ, “õ–∞—Ä–∞–ø–∞–π—ã–º ”ô–¥—ñ—Å—Ç—ñ –ø–∞–π–¥–∞–ª–∞–Ω—É');
                    createSimpleQR(verificationUrl);
                }
            } catch (error) {
                console.error('QR –∫–æ–¥ –∂–∞—Å–∞—É “õ–∞—Ç–µ—Å—ñ:', error);
                showQRError();
            }
            
            // –ö–µ—Ä—ñ —Å–∞–Ω–∞—É–¥—ã –±–∞—Å—Ç–∞—É
            startCountdown();
        }
        
        // “ö–∞—Ä–∞–ø–∞–π—ã–º QR –∫–æ–¥ –∂–∞—Å–∞—É (—Ä–µ–∑–µ—Ä–≤—Ç—ñ–∫ ”ô–¥—ñ—Å)
        function createSimpleQR(url) {
            const qrCodeDisplay = document.getElementById('qrCodeDisplay');
            
            // Google Charts API –∞—Ä“õ—ã–ª—ã QR –∫–æ–¥
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=280x280&data=${encodeURIComponent(url)}`;
            
            qrCodeDisplay.innerHTML = `
                <img src="${qrUrl}" 
                     alt="QR –∫–æ–¥" 
                     style="
                        display: block;
                        margin: 0 auto;
                        max-width: 280px;
                        height: auto;
                        border: 4px solid white;
                        border-radius: 10px;
                        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                     "
                     onerror="showQRError()"
                />
            `;
        }
        
        // QR –∫–æ–¥ “õ–∞—Ç–µ—Å—ñ–Ω –∫”©—Ä—Å–µ—Ç—É
        function showQRError() {
            const qrCodeDisplay = document.getElementById('qrCodeDisplay');
            qrCodeDisplay.innerHTML = `
                <div style="
                    background: white;
                    color: #333;
                    padding: 20px;
                    border-radius: 10px;
                    text-align: center;
                    border: 4px solid #ff6b6b;
                    max-width: 280px;
                    margin: 0 auto;
                ">
                    <div style="font-size: 2rem; margin-bottom: 10px;">üì±</div>
                    <div style="font-weight: bold; margin-bottom: 10px;">QR –∫–æ–¥ –¥–∞–π—ã–Ω!</div>
                    <div style="font-size: 0.9rem; margin-bottom: 15px;">–¢–µ–ª–µ—Ñ–æ–Ω–º–µ–Ω —Å–∫–∞–Ω–µ—Ä–ª–µ“£—ñ–∑</div>
                    <div style="
                        background: #f8f9fa;
                        padding: 10px;
                        border-radius: 5px;
                        font-size: 0.8rem;
                        word-break: break-all;
                        color: #666;
                    ">${window.location.href.split('?')[0]}?verify=${currentQRCode}</div>
                </div>
            `;
        }
        
        // –ö–µ—Ä—ñ —Å–∞–Ω–∞—É
        function startCountdown() {
            // –ê–ª–¥—ã“£“ì—ã –∏–Ω—Ç–µ—Ä–≤–∞–ª–¥—ã —Ç–æ“õ—Ç–∞—Ç—É
            if (countdownInterval) {
                clearInterval(countdownInterval);
            }
            
            const statusElement = document.getElementById('status');
            const timerElement = document.getElementById('qrTimer');
            
            countdownInterval = setInterval(() => {
                const now = Date.now();
                const timeLeft = Math.max(0, Math.ceil((qrValidUntil - now) / 1000));
                
                if (timeLeft > 0) {
                    // –¢–∞–π–º–µ—Ä –∂–∞“£–∞—Ä—Ç—É
                    if (timerElement) {
                        timerElement.textContent = `QR –∫–æ–¥ –∂–∞—Ä–∞–º–¥—ã: ${timeLeft} —Å–µ–∫—É–Ω–¥`;
                        timerElement.style.background = timeLeft > 5 ? 'rgba(255, 215, 0, 0.3)' : 'rgba(255, 0, 0, 0.3)';
                        timerElement.style.borderColor = timeLeft > 5 ? '#ffd700' : '#ff0000';
                        timerElement.style.color = timeLeft > 5 ? '#ffd700' : '#ff0000';
                    }
                    
                    // –°—Ç–∞—Ç—É—Å –∂–∞“£–∞—Ä—Ç—É
                    statusElement.textContent = `üì± QR –∫–æ–¥—Ç—ã —Ç–µ–ª–µ—Ñ–æ–Ω–º–µ–Ω —Å–∫–∞–Ω–µ—Ä–ª–µ“£—ñ–∑ (${timeLeft}—Å)`;
                    statusElement.style.background = timeLeft > 5 ? 'rgba(255, 255, 255, 0.2)' : 'rgba(255, 0, 0, 0.2)';
                    statusElement.style.borderColor = timeLeft > 5 ? 'rgba(255, 255, 255, 0.3)' : 'rgba(255, 0, 0, 0.5)';
                } else {
                    // –ú–µ—Ä–∑—ñ–º ”©—Ç–∫–µ–Ω–¥–µ
                    if (timerElement) {
                        timerElement.textContent = 'QR –∫–æ–¥ –º–µ—Ä–∑—ñ–º—ñ ”©—Ç—Ç—ñ!';
                        timerElement.style.background = 'rgba(255, 0, 0, 0.3)';
                        timerElement.style.borderColor = '#ff0000';
                        timerElement.style.color = '#ff0000';
                    }
                    
                    statusElement.textContent = '‚è∞ QR –∫–æ–¥ –º–µ—Ä–∑—ñ–º—ñ ”©—Ç—Ç—ñ! –ñ–∞“£–∞ QR –∫–æ–¥ –∂–∞—Å–∞–ª—É–¥–∞...';
                    statusElement.style.background = 'rgba(255, 0, 0, 0.3)';
                    statusElement.style.borderColor = 'rgba(255, 0, 0, 0.5)';
                    
                    clearInterval(countdownInterval);
                    
                    // –ñ–∞“£–∞ QR –∫–æ–¥ –∞–≤—Ç–æ–º–∞—Ç—Ç—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏—è–ª–∞—É
                    setTimeout(() => {
                        generateQRCode();
                    }, 2000);
                }
            }, 1000);
        }
        

        
        // QR –∫–æ–¥ —Ç–µ–∫—Å–µ—Ä—É
        function checkQRCode() {
            const urlParams = new URLSearchParams(window.location.search);
            const verifyCode = urlParams.get('verify');
            
            console.log('URL —Ç–µ–∫—Å–µ—Ä—ñ–ª—É–¥–µ:', window.location.href);
            console.log('Verify –∫–æ–¥:', verifyCode);
            
            if (verifyCode) {
                // QR –∫–æ–¥ —Ñ–æ—Ä–º–∞—Ç—ã–Ω —Ç–µ–∫—Å–µ—Ä—É
                if (verifyCode.startsWith('VERIFY_')) {
                    // QR –∫–æ–¥ –º–µ—Ä–∑—ñ–º—ñ–Ω –¥–µ—Ä–µ—É —Ç–µ–∫—Å–µ—Ä—É
                    const timestamp = parseInt(verifyCode.split('_')[1]);
                    const currentTime = Date.now();
                    const timeDiff = currentTime - timestamp;
                    
                    console.log('QR –∫–æ–¥ –º–µ—Ä–∑—ñ–º—ñ —Ç–µ–∫—Å–µ—Ä—ñ–ª—É–¥–µ:', {
                        timestamp: timestamp,
                        currentTime: currentTime,
                        timeDiff: timeDiff,
                        expired: timeDiff > 15000
                    });
                    
                    if (timeDiff > 15000) {
                        console.log('QR –∫–æ–¥ –º–µ—Ä–∑—ñ–º—ñ ”©—Ç—Ç—ñ, “õ–∞—Ç–µ —ç–∫—Ä–∞–Ω—ã–Ω –∫”©—Ä—Å–µ—Ç—É');
                        showExpiredQRScreen(timeDiff);
                    } else {
                        console.log('QR –∫–æ–¥ –∂–∞—Ä–∞–º–¥—ã, —Ç–µ–ª–µ—Ñ–æ–Ω —ç–∫—Ä–∞–Ω—ã–Ω –∫”©—Ä—Å–µ—Ç—É...');
                        showMobileVerificationScreen(verifyCode);
                    }
                    
                    // URL-–¥—ñ —Ç–∞–∑–∞–ª–∞—É (–±—ñ—Ä–∞“õ –∫–µ–π—ñ–Ω—ñ—Ä–µ–∫)
                    setTimeout(() => {
                        window.history.replaceState({}, document.title, window.location.pathname);
                    }, 1000);
                } else {
                    console.log('–ñ–∞—Ä–∞–º—Å—ã–∑ QR –∫–æ–¥ —Ñ–æ—Ä–º–∞—Ç—ã:', verifyCode);
                }
            } else {
                console.log('URL-–¥–µ verify –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ –∂–æ“õ');
            }
        }
        
        // –ú–µ—Ä–∑—ñ–º—ñ ”©—Ç–∫–µ–Ω QR —ç–∫—Ä–∞–Ω—ã–Ω –∫”©—Ä—Å–µ—Ç—É
        function showExpiredQRScreen(timeDiff) {
            document.body.innerHTML = `
                <div style="
                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                    background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
                    min-height: 100vh;
                    padding: 20px;
                    margin: 0;
                    color: white;
                    box-sizing: border-box;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                ">
                    <div style="
                        background: rgba(255, 255, 255, 0.15);
                        backdrop-filter: blur(10px);
                        border-radius: 20px;
                        padding: 30px;
                        text-align: center;
                        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                        border: 2px solid rgba(255, 255, 255, 0.3);
                        animation: shake 0.5s ease-in-out;
                    ">
                        <div style="font-size: 4rem; margin-bottom: 20px;">‚è∞</div>
                        <h1 style="font-size: 1.8rem; margin-bottom: 15px;">QR –∫–æ–¥ –º–µ—Ä–∑—ñ–º—ñ ”©—Ç—Ç—ñ!</h1>
                        <p style="font-size: 1.1rem; margin-bottom: 20px; opacity: 0.9;">
                            –ë“±–ª QR –∫–æ–¥ ${Math.round(timeDiff/1000)} —Å–µ–∫—É–Ω–¥ –±“±—Ä—ã–Ω –∂–∞—Å–∞–ª“ì–∞–Ω.
                        </p>
                        <p style="font-size: 1rem; margin-bottom: 25px; opacity: 0.8;">
                            –ñ–∞“£–∞ QR –∫–æ–¥ –∞–ª—É “Ø—à—ñ–Ω –º“±“ì–∞–ª—ñ–º–≥–µ —Ö–∞–±–∞—Ä–ª–∞—Å—ã“£—ã–∑.
                        </p>
                        <button onclick="window.close()" style="
                            background: linear-gradient(45deg, #6c757d, #495057);
                            color: white;
                            border: none;
                            padding: 12px 30px;
                            border-radius: 25px;
                            font-size: 1rem;
                            font-weight: 600;
                            cursor: pointer;
                            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                            transition: all 0.3s ease;
                        " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                            üîô –ñ–∞–±—É
                        </button>
                    </div>
                </div>
            `;
        }

        // –¢–µ–ª–µ—Ñ–æ–Ω —Ä–∞—Å—Ç–∞—É —ç–∫—Ä–∞–Ω—ã–Ω –∫”©—Ä—Å–µ—Ç—É
        function showMobileVerificationScreen(verifyCode) {
            
            // –°–∞“õ—Ç–∞–ª“ì–∞–Ω –æ“õ—É—à—ã–ª–∞—Ä —Ç—ñ–∑—ñ–º—ñ–Ω –∞–ª—É
            const savedData = localStorage.getItem('classData');
            let availableStudents = [];
            let currentClassTitle = '–°—ã–Ω—ã–ø';
            
            if (savedData) {
                const classData = JSON.parse(savedData);
                availableStudents = classData.students || [];
                currentClassTitle = classData.className || '–°—ã–Ω—ã–ø';
            }
            
            // –ï–≥–µ—Ä —Å–∞“õ—Ç–∞–ª“ì–∞–Ω –¥–µ—Ä–µ–∫—Ç–µ—Ä –∂–æ“õ –±–æ–ª—Å–∞, –∞“ì—ã–º–¥–∞“ì—ã students –º–∞—Å—Å–∏–≤—ñ–Ω –ø–∞–π–¥–∞–ª–∞–Ω—É
            if (availableStudents.length === 0 && window.opener && window.opener.students && window.opener.students.length > 0) {
                availableStudents = window.opener.students;
                currentClassTitle = window.opener.currentClassName || '–°—ã–Ω—ã–ø';
            }
            
            // –ï–≥–µ—Ä ”ô–ª—ñ –¥–µ –æ“õ—É—à—ã–ª–∞—Ä –∂–æ“õ –±–æ–ª—Å–∞, localStorage-—Ç–∞–Ω —Å–∞“õ—Ç–∞–ª“ì–∞–Ω —Å—ã–Ω—ã–ø—Ç–∞—Ä–¥—ã —Ç–µ–∫—Å–µ—Ä—É
            if (availableStudents.length === 0) {
                const savedClasses = localStorage.getItem('savedClasses');
                if (savedClasses) {
                    const classesData = JSON.parse(savedClasses);
                    const classNames = Object.keys(classesData);
                    if (classNames.length > 0) {
                        // –°–æ“£“ì—ã —Å–∞“õ—Ç–∞–ª“ì–∞–Ω —Å—ã–Ω—ã–ø—Ç—ã –∞–ª—É
                        const lastClassName = classNames[classNames.length - 1];
                        availableStudents = classesData[lastClassName].students || [];
                        currentClassTitle = lastClassName;
                    }
                }
            }
            
            // –û“õ—É—à—ã–ª–∞—Ä–¥—ã —Ç—ñ–∑—ñ–º —Ç“Ø—Ä—ñ–Ω–¥–µ –∫”©—Ä—Å–µ—Ç—É
            let studentsListHTML = '';
            if (availableStudents.length > 0) {
                const studentsGrid = availableStudents.map((student, index) => {
                    const statusText = student.verified ? '‚úÖ –†–∞—Å—Ç–∞–ª“ì–∞–Ω' : '‚è≥ –†–∞—Å—Ç–∞—É–¥—ã –∫“Ø—Ç—É–¥–µ';
                    const statusColor = student.verified ? '#00ff00' : '#ffd700';
                    const buttonDisabled = student.verified ? 'disabled' : '';
                    const buttonText = student.verified ? '–†–∞—Å—Ç–∞–ª“ì–∞–Ω' : '‚úÖ –†–∞—Å—Ç–∞—É';
                    const cardBg = student.verified ? 'rgba(0, 255, 0, 0.2)' : 'rgba(255, 255, 255, 0.2)';
                    const borderColor = student.verified ? '#00ff00' : 'rgba(255, 255, 255, 0.3)';
                    
                    return `
                        <div style="
                            background: ${cardBg};
                            padding: 15px;
                            border-radius: 15px;
                            margin-bottom: 10px;
                            border: 2px solid ${borderColor};
                            transition: all 0.3s ease;
                            ${student.verified ? 'box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);' : ''}
                        ">
                            <div style="
                                display: flex;
                                justify-content: space-between;
                                align-items: center;
                            ">
                                <div style="flex: 1;">
                                    <div style="
                                        font-weight: bold;
                                        margin-bottom: 5px;
                                        font-size: 1.1rem;
                                        line-height: 1.2;
                                    ">${student.name}</div>
                                    <div style="
                                        color: ${statusColor};
                                        font-size: 0.9rem;
                                        font-weight: 600;
                                    ">${statusText}</div>
                                </div>
                                <button onclick="verifyStudent('${student.name}')" ${buttonDisabled} style="
                                    background: ${student.verified ? 'rgba(0, 255, 0, 0.4)' : 'linear-gradient(45deg, #ff6b6b, #ee5a24)'};
                                    color: white;
                                    border: none;
                                    padding: 10px 20px;
                                    border-radius: 20px;
                                    font-size: 0.9rem;
                                    font-weight: 600;
                                    cursor: ${student.verified ? 'not-allowed' : 'pointer'};
                                    opacity: ${student.verified ? '0.7' : '1'};
                                    transition: all 0.3s ease;
                                    min-width: 80px;
                                    box-shadow: ${student.verified ? 'none' : '0 4px 15px rgba(0, 0, 0, 0.2)'};
                                " ${!student.verified ? `onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'"` : ''}>
                                    ${buttonText}
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
                
                studentsListHTML = studentsGrid;
            }
            
            document.body.innerHTML = `
                <div style="
                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    min-height: 100vh;
                    padding: 15px;
                    margin: 0;
                    color: white;
                    box-sizing: border-box;
                ">
                    <div style="
                        background: rgba(255, 255, 255, 0.15);
                        backdrop-filter: blur(10px);
                        border-radius: 20px;
                        padding: 20px;
                        width: 100%;
                        max-width: 100%;
                        margin: 0 auto;
                        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                    ">
                        <h1 style="
                            font-size: 1.6rem;
                            margin-bottom: 10px;
                            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
                            text-align: center;
                        ">üéì ${currentClassTitle}</h1>
                        
                        <p style="
                            font-size: 1rem;
                            margin-bottom: 20px;
                            opacity: 0.9;
                            text-align: center;
                            background: rgba(255, 255, 255, 0.1);
                            padding: 10px;
                            border-radius: 10px;
                        ">üì± QR –∫–æ–¥ —Å”ô—Ç—Ç—ñ —Å–∫–∞–Ω–µ—Ä–ª–µ–Ω–¥—ñ!<br>”®–∑ –∞—Ç—ã“£—ã–∑–¥—ã —Ç–∞—É—ã–ø —Ä–∞—Å—Ç–∞—É –±–∞—Ç—ã—Ä–º–∞—Å—ã–Ω –±–∞—Å—ã“£—ã–∑:</p>
                        
                        <div style="
                            max-height: 65vh;
                            overflow-y: auto;
                            margin-bottom: 20px;
                            padding-right: 5px;
                        ">
                            ${availableStudents.length > 0 ? studentsListHTML : `
                                <div style="
                                    padding: 40px 20px;
                                    background: rgba(255, 0, 0, 0.2);
                                    border-radius: 15px;
                                    text-align: center;
                                    border: 2px dashed rgba(255, 0, 0, 0.5);
                                ">
                                    <div style="font-size: 3rem; margin-bottom: 15px;">üìù</div>
                                    <h3 style="margin-bottom: 10px; font-size: 1.3rem;">–û“õ—É—à—ã–ª–∞—Ä —Ç—ñ–∑—ñ–º—ñ –±–æ—Å</h3>
                                    <p style="opacity: 0.8; margin: 0; font-size: 1rem;">–ê–ª–¥—ã–º–µ–Ω –Ω–µ–≥—ñ–∑–≥—ñ –±–µ—Ç—Ç–µ –æ“õ—É—à—ã–ª–∞—Ä–¥—ã “õ–æ—Å—ã“£—ã–∑</p>
                                </div>
                            `}
                        </div>
                        
                        <button onclick="window.close()" style="
                            background: linear-gradient(45deg, #6c757d, #495057);
                            color: white;
                            border: none;
                            padding: 12px 25px;
                            border-radius: 25px;
                            font-size: 1rem;
                            font-weight: 600;
                            cursor: pointer;
                            width: 100%;
                            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                            transition: all 0.3s ease;
                        " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                            üîô –ñ–∞–±—É
                        </button>
                        
                        <div id="mobileStatus" style="
                            margin-top: 15px;
                            padding: 12px;
                            border-radius: 15px;
                            background: rgba(255, 255, 255, 0.1);
                            display: none;
                            text-align: center;
                            font-size: 1rem;
                            font-weight: 600;
                            border: 2px solid rgba(255, 255, 255, 0.2);
                        "></div>
                    </div>
                </div>
            `;
        }
        

        
        // –û“õ—É—à—ã–Ω—ã —Ä–∞—Å—Ç–∞—É (–∂–∞“£–∞ —Ñ—É–Ω–∫—Ü–∏—è)
        function verifyStudent(studentName) {
            const statusDiv = document.getElementById('mobileStatus');
            
            if (!studentName) {
                statusDiv.style.display = 'block';
                statusDiv.style.background = 'rgba(255, 0, 0, 0.2)';
                statusDiv.textContent = '“ö–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª–¥—ã!';
                return;
            }
            
            // QR –∫–æ–¥ –º–µ—Ä–∑—ñ–º—ñ–Ω “õ–∞—Ç–∞“£ —Ç–µ–∫—Å–µ—Ä—É
            const urlParams = new URLSearchParams(window.location.search);
            let verifyCode = urlParams.get('verify');
            
            console.log('–†–∞—Å—Ç–∞—É –∫–µ–∑—ñ–Ω–¥–µ QR –∫–æ–¥ —Ç–µ–∫—Å–µ—Ä—É:', {
                verifyCode: verifyCode,
                url: window.location.href
            });
            
            if (verifyCode && verifyCode.startsWith('VERIFY_')) {
                const timestamp = parseInt(verifyCode.split('_')[1]);
                const currentTime = Date.now();
                const timeDiff = currentTime - timestamp;
                
                console.log('–†–∞—Å—Ç–∞—É –∫–µ–∑—ñ–Ω–¥–µ –º–µ—Ä–∑—ñ–º —Ç–µ–∫—Å–µ—Ä—É:', {
                    timestamp: timestamp,
                    currentTime: currentTime,
                    timeDiff: timeDiff,
                    expired: timeDiff > 15000
                });
                
                // 15 —Å–µ–∫—É–Ω–¥ ”©—Ç–∫–µ–Ω –±–æ–ª—Å–∞
                if (timeDiff > 15000) {
                    statusDiv.style.display = 'block';
                    statusDiv.style.background = 'rgba(255, 0, 0, 0.2)';
                    statusDiv.style.borderColor = 'rgba(255, 0, 0, 0.5)';
                    statusDiv.textContent = `‚ùå QR –∫–æ–¥ –º–µ—Ä–∑—ñ–º—ñ ”©—Ç—Ç—ñ! (${Math.round(timeDiff/1000)} —Å–µ–∫—É–Ω–¥ ”©—Ç—Ç—ñ)`;
                    
                    // –î—ñ—Ä—ñ–ª–¥–µ—Ç—É —ç—Ñ—Ñ–µ–∫—Ç—ñ–Ω “õ–æ—Å—É
                    statusDiv.style.animation = 'shake 0.5s ease-in-out';
                    
                    setTimeout(() => {
                        window.close();
                    }, 3000);
                    return;
                }
            } else {
                statusDiv.style.display = 'block';
                statusDiv.style.background = 'rgba(255, 0, 0, 0.2)';
                statusDiv.style.borderColor = 'rgba(255, 0, 0, 0.5)';
                statusDiv.textContent = '‚ùå –ñ–∞—Ä–∞–º—Å—ã–∑ QR –∫–æ–¥!';
                statusDiv.style.animation = 'shake 0.5s ease-in-out';
                
                setTimeout(() => {
                    window.close();
                }, 3000);
                return;
            }
            
            statusDiv.style.display = 'block';
            statusDiv.style.background = 'rgba(255, 255, 0, 0.2)';
            statusDiv.textContent = '–†–∞—Å—Ç–∞—É –∂“Ø—Ä—ñ–ø –∂–∞—Ç—ã—Ä...';
            
            // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –∞–ª—É
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        
                        // –ù–µ–≥—ñ–∑–≥—ñ —Ç–µ—Ä–µ–∑–µ–≥–µ –¥–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ –∂—ñ–±–µ—Ä—É
                        const data = {
                            name: studentName,
                            location: { lat, lng },
                            timestamp: new Date().toLocaleString('kk-KZ'),
                            verified: true,
                            verificationTime: new Date().toLocaleString('kk-KZ'),
                            id: Date.now()
                        };
                        
                        console.log('–î–µ—Ä–µ–∫—Ç–µ—Ä —Å–∞“õ—Ç–∞–ª—É–¥–∞:', data);
                        
                        // localStorage –∞—Ä“õ—ã–ª—ã –¥–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ —Å–∞“õ—Ç–∞—É
                        localStorage.setItem('newVerification', JSON.stringify(data));
                        localStorage.setItem('verificationTime', Date.now().toString());
                        
                        // –ê“ì—ã–º–¥–∞“ì—ã —Å—ã–Ω—ã–ø—Ç—ã –¥–∞ –∂–∞“£–∞—Ä—Ç—É
                        const currentClassData = localStorage.getItem('classData');
                        if (currentClassData) {
                            const classData = JSON.parse(currentClassData);
                            const studentToUpdate = classData.students.find(s => s.name === studentName);
                            if (studentToUpdate) {
                                studentToUpdate.verified = true;
                                studentToUpdate.verificationTime = data.verificationTime;
                                studentToUpdate.location = data.location;
                                localStorage.setItem('classData', JSON.stringify(classData));
                            }
                        }
                        
                        statusDiv.style.background = 'rgba(0, 255, 0, 0.2)';
                        statusDiv.textContent = `‚úÖ ${studentName} —Å”ô—Ç—Ç—ñ —Ä–∞—Å—Ç–∞–ª–¥—ã!`;
                        
                        setTimeout(() => {
                            window.close();
                        }, 2000);
                    },
                    (error) => {
                        // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è—Å—ã–∑ —Ä–∞—Å—Ç–∞—É
                        const data = {
                            name: studentName,
                            location: null,
                            timestamp: new Date().toLocaleString('kk-KZ'),
                            verified: true,
                            verificationTime: new Date().toLocaleString('kk-KZ'),
                            id: Date.now()
                        };
                        
                        console.log('–î–µ—Ä–µ–∫—Ç–µ—Ä —Å–∞“õ—Ç–∞–ª—É–¥–∞ (–≥–µ–æ–ª–æ–∫–∞—Ü–∏—è—Å—ã–∑):', data);
                        
                        localStorage.setItem('newVerification', JSON.stringify(data));
                        localStorage.setItem('verificationTime', Date.now().toString());
                        
                        // –ê“ì—ã–º–¥–∞“ì—ã —Å—ã–Ω—ã–ø—Ç—ã –¥–∞ –∂–∞“£–∞—Ä—Ç—É
                        const currentClassData = localStorage.getItem('classData');
                        if (currentClassData) {
                            const classData = JSON.parse(currentClassData);
                            const studentToUpdate = classData.students.find(s => s.name === studentName);
                            if (studentToUpdate) {
                                studentToUpdate.verified = true;
                                studentToUpdate.verificationTime = data.verificationTime;
                                studentToUpdate.location = data.location;
                                localStorage.setItem('classData', JSON.stringify(classData));
                            }
                        }
                        
                        statusDiv.style.background = 'rgba(0, 255, 0, 0.2)';
                        statusDiv.textContent = `‚úÖ ${studentName} —Å”ô—Ç—Ç—ñ —Ä–∞—Å—Ç–∞–ª–¥—ã!`;
                        
                        setTimeout(() => {
                            window.close();
                        }, 2000);
                    }
                );
            } else {
                // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è—Å—ã–∑ —Ä–∞—Å—Ç–∞—É
                const data = {
                    name: studentName,
                    location: null,
                    timestamp: new Date().toLocaleString('kk-KZ'),
                    verified: true,
                    verificationTime: new Date().toLocaleString('kk-KZ'),
                    id: Date.now()
                };
                
                console.log('–î–µ—Ä–µ–∫—Ç–µ—Ä —Å–∞“õ—Ç–∞–ª—É–¥–∞ (–≥–µ–æ–ª–æ–∫–∞—Ü–∏—è –∂–æ“õ):', data);
                
                localStorage.setItem('newVerification', JSON.stringify(data));
                localStorage.setItem('verificationTime', Date.now().toString());
                
                // –ê“ì—ã–º–¥–∞“ì—ã —Å—ã–Ω—ã–ø—Ç—ã –¥–∞ –∂–∞“£–∞—Ä—Ç—É
                const currentClassData = localStorage.getItem('classData');
                if (currentClassData) {
                    const classData = JSON.parse(currentClassData);
                    const studentToUpdate = classData.students.find(s => s.name === studentName);
                    if (studentToUpdate) {
                        studentToUpdate.verified = true;
                        studentToUpdate.verificationTime = data.verificationTime;
                        studentToUpdate.location = data.location;
                        localStorage.setItem('classData', JSON.stringify(classData));
                    }
                }
                
                statusDiv.style.background = 'rgba(0, 255, 0, 0.2)';
                statusDiv.textContent = `‚úÖ ${studentName} —Å”ô—Ç—Ç—ñ —Ä–∞—Å—Ç–∞–ª–¥—ã!`;
                
                setTimeout(() => {
                    window.close();
                }, 2000);
            }
        }
        
        // –¢–µ–ª–µ—Ñ–æ–Ω–Ω–∞–Ω —Ä–∞—Å—Ç–∞—É–¥—ã –∂—ñ–±–µ—Ä—É (–µ—Å–∫—ñ —Ñ—É–Ω–∫—Ü–∏—è - –µ–Ω–¥—ñ “õ–æ–ª–¥–∞–Ω—ã–ª–º–∞–π–¥—ã)
        function submitMobileVerification() {
            const studentSelect = document.getElementById('mobileStudentSelect');
            const statusDiv = document.getElementById('mobileStatus');
            
            if (!studentSelect) {
                statusDiv.style.display = 'block';
                statusDiv.style.background = 'rgba(255, 0, 0, 0.2)';
                statusDiv.textContent = '“ö–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª–¥—ã!';
                return;
            }
            
            const selectedStudent = studentSelect.value.trim();
            
            if (!selectedStudent) {
                statusDiv.style.display = 'block';
                statusDiv.style.background = 'rgba(255, 0, 0, 0.2)';
                statusDiv.textContent = '–ê—Ç—ã“£—ã–∑–¥—ã —Ç–∞“£–¥–∞“£—ã–∑!';
                return;
            }
            
            // QR –∫–æ–¥ –º–µ—Ä–∑—ñ–º—ñ–Ω “õ–∞—Ç–∞“£ —Ç–µ–∫—Å–µ—Ä—É
            const urlParams = new URLSearchParams(window.location.search);
            let verifyCode = urlParams.get('verify');
            
            if (verifyCode && verifyCode.startsWith('VERIFY_')) {
                const timestamp = parseInt(verifyCode.split('_')[1]);
                const currentTime = Date.now();
                const timeDiff = currentTime - timestamp;
                
                console.log('QR –∫–æ–¥ —Ç–µ–∫—Å–µ—Ä—É:', {
                    timestamp: timestamp,
                    currentTime: currentTime,
                    timeDiff: timeDiff,
                    expired: timeDiff > 15000
                });
                
                // 15 —Å–µ–∫—É–Ω–¥ ”©—Ç–∫–µ–Ω –±–æ–ª—Å–∞
                if (timeDiff > 15000) {
                    statusDiv.style.display = 'block';
                    statusDiv.style.background = 'rgba(255, 0, 0, 0.2)';
                    statusDiv.textContent = `‚ùå QR –∫–æ–¥ –º–µ—Ä–∑—ñ–º—ñ ”©—Ç—Ç—ñ! (${Math.round(timeDiff/1000)} —Å–µ–∫—É–Ω–¥ ”©—Ç—Ç—ñ)`;
                    
                    setTimeout(() => {
                        window.close();
                    }, 3000);
                    return;
                }
            } else {
                statusDiv.style.display = 'block';
                statusDiv.style.background = 'rgba(255, 0, 0, 0.2)';
                statusDiv.textContent = '‚ùå –ñ–∞—Ä–∞–º—Å—ã–∑ QR –∫–æ–¥!';
                
                setTimeout(() => {
                    window.close();
                }, 3000);
                return;
            }
            
            statusDiv.style.display = 'block';
            statusDiv.style.background = 'rgba(255, 255, 0, 0.2)';
            statusDiv.textContent = '–†–∞—Å—Ç–∞—É –∂“Ø—Ä—ñ–ø –∂–∞—Ç—ã—Ä...';
            
            // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –∞–ª—É
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        
                        // –ù–µ–≥—ñ–∑–≥—ñ —Ç–µ—Ä–µ–∑–µ–≥–µ –¥–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ –∂—ñ–±–µ—Ä—É
                        const data = {
                            name: selectedStudent,
                            location: { lat, lng },
                            timestamp: new Date().toLocaleString('kk-KZ'),
                            verified: true,
                            verificationTime: new Date().toLocaleString('kk-KZ'),
                            id: Date.now()
                        };
                        
                        console.log('–î–µ—Ä–µ–∫—Ç–µ—Ä —Å–∞“õ—Ç–∞–ª—É–¥–∞:', data);
                        
                        // localStorage –∞—Ä“õ—ã–ª—ã –¥–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ —Å–∞“õ—Ç–∞—É
                        localStorage.setItem('newVerification', JSON.stringify(data));
                        localStorage.setItem('verificationTime', Date.now().toString());
                        
                        // –ê“ì—ã–º–¥–∞“ì—ã —Å—ã–Ω—ã–ø—Ç—ã –¥–∞ –∂–∞“£–∞—Ä—Ç—É
                        const currentClassData = localStorage.getItem('classData');
                        if (currentClassData) {
                            const classData = JSON.parse(currentClassData);
                            const studentToUpdate = classData.students.find(s => s.name === selectedStudent);
                            if (studentToUpdate) {
                                studentToUpdate.verified = true;
                                studentToUpdate.verificationTime = data.verificationTime;
                                studentToUpdate.location = data.location;
                                localStorage.setItem('classData', JSON.stringify(classData));
                            }
                        }
                        
                        statusDiv.style.background = 'rgba(0, 255, 0, 0.2)';
                        statusDiv.textContent = `‚úÖ ${selectedStudent} —Å”ô—Ç—Ç—ñ —Ä–∞—Å—Ç–∞–ª–¥—ã!`;
                        
                        setTimeout(() => {
                            window.close();
                        }, 2000);
                    },
                    (error) => {
                        // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è—Å—ã–∑ —Ä–∞—Å—Ç–∞—É
                        const data = {
                            name: selectedStudent,
                            location: null,
                            timestamp: new Date().toLocaleString('kk-KZ'),
                            verified: true,
                            verificationTime: new Date().toLocaleString('kk-KZ'),
                            id: Date.now()
                        };
                        
                        console.log('–î–µ—Ä–µ–∫—Ç–µ—Ä —Å–∞“õ—Ç–∞–ª—É–¥–∞ (–≥–µ–æ–ª–æ–∫–∞—Ü–∏—è—Å—ã–∑):', data);
                        
                        localStorage.setItem('newVerification', JSON.stringify(data));
                        localStorage.setItem('verificationTime', Date.now().toString());
                        
                        // –ê“ì—ã–º–¥–∞“ì—ã —Å—ã–Ω—ã–ø—Ç—ã –¥–∞ –∂–∞“£–∞—Ä—Ç—É
                        const currentClassData = localStorage.getItem('classData');
                        if (currentClassData) {
                            const classData = JSON.parse(currentClassData);
                            const studentToUpdate = classData.students.find(s => s.name === selectedStudent);
                            if (studentToUpdate) {
                                studentToUpdate.verified = true;
                                studentToUpdate.verificationTime = data.verificationTime;
                                studentToUpdate.location = data.location;
                                localStorage.setItem('classData', JSON.stringify(classData));
                            }
                        }
                        
                        statusDiv.style.background = 'rgba(0, 255, 0, 0.2)';
                        statusDiv.textContent = `‚úÖ ${selectedStudent} —Å”ô—Ç—Ç—ñ —Ä–∞—Å—Ç–∞–ª–¥—ã!`;
                        
                        setTimeout(() => {
                            window.close();
                        }, 2000);
                    }
                );
            } else {
                // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è—Å—ã–∑ —Ä–∞—Å—Ç–∞—É
                const data = {
                    name: selectedStudent,
                    location: null,
                    timestamp: new Date().toLocaleString('kk-KZ'),
                    verified: true,
                    verificationTime: new Date().toLocaleString('kk-KZ'),
                    id: Date.now()
                };
                
                console.log('–î–µ—Ä–µ–∫—Ç–µ—Ä —Å–∞“õ—Ç–∞–ª—É–¥–∞ (–≥–µ–æ–ª–æ–∫–∞—Ü–∏—è –∂–æ“õ):', data);
                
                localStorage.setItem('newVerification', JSON.stringify(data));
                localStorage.setItem('verificationTime', Date.now().toString());
                
                // –ê“ì—ã–º–¥–∞“ì—ã —Å—ã–Ω—ã–ø—Ç—ã –¥–∞ –∂–∞“£–∞—Ä—Ç—É
                const currentClassData = localStorage.getItem('classData');
                if (currentClassData) {
                    const classData = JSON.parse(currentClassData);
                    const studentToUpdate = classData.students.find(s => s.name === selectedStudent);
                    if (studentToUpdate) {
                        studentToUpdate.verified = true;
                        studentToUpdate.verificationTime = data.verificationTime;
                        studentToUpdate.location = data.location;
                        localStorage.setItem('classData', JSON.stringify(classData));
                    }
                }
                
                statusDiv.style.background = 'rgba(0, 255, 0, 0.2)';
                statusDiv.textContent = `‚úÖ ${selectedStudent} —Å”ô—Ç—Ç—ñ —Ä–∞—Å—Ç–∞–ª–¥—ã!`;
                
                setTimeout(() => {
                    window.close();
                }, 2000);
            }
        }
        
        // localStorage-—Ç–∞–Ω –∂–∞“£–∞ —Ä–∞—Å—Ç–∞—É–ª–∞—Ä–¥—ã —Ç–µ–∫—Å–µ—Ä—É
        function checkForNewVerifications() {
            try {
                const newVerification = localStorage.getItem('newVerification');
                if (newVerification) {
                    console.log('–ñ–∞“£–∞ —Ä–∞—Å—Ç–∞—É —Ç–∞–±—ã–ª–¥—ã:', newVerification);
                    const userData = JSON.parse(newVerification);
                    
                    // –û“õ—É—à—ã–Ω—ã —Ç–∞–±—É –∂”ô–Ω–µ —Ä–∞—Å—Ç–∞—É
                    const student = students.find(s => s.name === userData.name);
                    if (student && !student.verified) {
                        student.verified = true;
                        student.verificationTime = userData.verificationTime || userData.timestamp;
                        student.location = userData.location;
                        
                        // –†–∞—Å—Ç–∞–ª“ì–∞–Ω –ø–∞–π–¥–∞–ª–∞–Ω—É—à—ã–ª–∞—Ä —Ç—ñ–∑—ñ–º—ñ–Ω–µ “õ–æ—Å—É
                        const verifiedUser = {
                            name: student.name,
                            timestamp: student.verificationTime,
                            location: student.location,
                            qrCode: currentQRCode,
                            id: student.id
                        };
                        
                        // “ö–∞–π—Ç–∞–ª–∞–Ω–±–∞—É—ã–Ω —Ç–µ–∫—Å–µ—Ä—É
                        const exists = verifiedUsers.find(user => 
                            user.name === userData.name && 
                            Math.abs(new Date(user.timestamp) - new Date(userData.timestamp)) < 5000
                        );
                        
                        if (!exists) {
                            verifiedUsers.push(verifiedUser);
                            console.log('–ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã “õ–æ—Å—ã–ª–¥—ã:', verifiedUser);
                            
                            // –ë–∞—Ä–ª—ã“õ —Ç—ñ–∑—ñ–º–¥–µ—Ä–¥—ñ –∂–∞“£–∞—Ä—Ç—É
                            updateStudentsList();
                            updateStudentsGrid();
                            updateGeolocationList();
                            
                            // –°—ã–Ω—ã–ø—Ç—ã localStorage-“õ–∞ —Å–∞“õ—Ç–∞—É
                            if (currentClassName) {
                                localStorage.setItem('classData', JSON.stringify({
                                    className: currentClassName,
                                    students: students
                                }));
                            }
                            
                            // –°—Ç–∞—Ç—É—Å—Ç—ã –∂–∞“£–∞—Ä—Ç—É - –∂–∞—Å—ã–ª –∂–∞—Ä“õ—ã—Ä–∞—É —ç—Ñ—Ñ–µ–∫—Ç—ñ–º–µ–Ω
                            const statusElement = document.getElementById('status');
                            if (statusElement) {
                                statusElement.textContent = `üéâ ${userData.name} —Å”ô—Ç—Ç—ñ —Ä–∞—Å—Ç–∞–ª–¥—ã!`;
                                statusElement.style.background = 'linear-gradient(45deg, #00ff00, #32cd32)';
                                statusElement.style.borderColor = '#00ff00';
                                statusElement.style.boxShadow = '0 0 30px rgba(0, 255, 0, 0.6)';
                                statusElement.style.animation = 'pulse 1s infinite';
                                statusElement.style.transform = 'scale(1.05)';
                                
                                // –ñ–∞—Ä“õ—ã—Ä–∞—É —ç—Ñ—Ñ–µ–∫—Ç—ñ–Ω “õ–æ—Å—É
                                setTimeout(() => {
                                    statusElement.style.animation = 'none';
                                    statusElement.style.transform = 'scale(1)';
                                    statusElement.style.boxShadow = 'none';
                                }, 2000);
                                
                                setTimeout(() => {
                                    statusElement.textContent = 'QR –∫–æ–¥—Ç—ã —Ç–µ–ª–µ—Ñ–æ–Ω–º–µ–Ω —Å–∫–∞–Ω–µ—Ä–ª–µ“£—ñ–∑';
                                    statusElement.style.background = 'rgba(255, 255, 255, 0.2)';
                                    statusElement.style.borderColor = 'rgba(255, 255, 255, 0.3)';
                                }, 4000);
                            }
                            
                            // –û“õ—É—à—ã –∫–∞—Ä—Ç–∞—Å—ã–Ω –∂–∞—Ä“õ—ã—Ä–∞—Ç—ã–ø –∫”©—Ä—Å–µ—Ç—É
                            const studentCards = document.querySelectorAll('.student-card');
                            studentCards.forEach(card => {
                                const cardName = card.querySelector('div').textContent;
                                if (cardName === userData.name) {
                                    card.style.animation = 'pulse 2s infinite';
                                    card.style.boxShadow = '0 0 25px rgba(0, 255, 0, 0.8)';
                                    
                                    setTimeout(() => {
                                        card.style.animation = 'pulse 2s infinite';
                                    }, 3000);
                                }
                            });
                        }
                    }
                    
                    // localStorage-—Ç—ã —Ç–∞–∑–∞–ª–∞—É
                    localStorage.removeItem('newVerification');
                }
            } catch (error) {
                console.error('–†–∞—Å—Ç–∞—É–¥—ã —Ç–µ–∫—Å–µ—Ä—É “õ–∞—Ç–µ—Å—ñ:', error);
            }
        }
        
        // –°–∞“õ—Ç–∞–ª“ì–∞–Ω –¥–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ –∂“Ø–∫—Ç–µ—É
        function loadSavedData() {
            try {
                // –°–∞“õ—Ç–∞–ª“ì–∞–Ω —Å—ã–Ω—ã–ø—Ç–∞—Ä–¥—ã –∂“Ø–∫—Ç–µ—É
                const savedClassesData = localStorage.getItem('savedClasses');
                if (savedClassesData) {
                    savedClasses = JSON.parse(savedClassesData);
                }
                
                // –ê“ì—ã–º–¥–∞“ì—ã —Å—ã–Ω—ã–ø—Ç—ã –∂“Ø–∫—Ç–µ—É
                const savedData = localStorage.getItem('classData');
                if (savedData) {
                    const classData = JSON.parse(savedData);
                    currentClassName = classData.className || '';
                    students = classData.students || [];
                    
                    document.getElementById('className').value = currentClassName;
                    document.getElementById('currentClassName').textContent = currentClassName || '–°—ã–Ω—ã–ø —Ç–∞“£–¥–∞–ª–º–∞“ì–∞–Ω';
                    
                    updateStudentsList();
                    updateStudentsGrid();
                    updateGeolocationList();
                }
                
                updateSavedClassesList();
            } catch (error) {
                console.error('–î–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ –∂“Ø–∫—Ç–µ—É “õ–∞—Ç–µ—Å—ñ:', error);
            }
        }
        
        // Enter –ø–µ—Ä–Ω–µ—Å—ñ–Ω –±–∞—Å“õ–∞–Ω–¥–∞ –æ“õ—É—à—ã “õ–æ—Å—É
        document.addEventListener('DOMContentLoaded', function() {
            const studentNameInput = document.getElementById('studentName');
            if (studentNameInput) {
                studentNameInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        addStudent();
                    }
                });
            }
            
            const studentsTextArea = document.getElementById('studentsText');
            if (studentsTextArea) {
                studentsTextArea.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && e.ctrlKey) {
                        e.preventDefault();
                        addMultipleStudents();
                    }
                });
            }
        });
        
        // –ë–∞—Å—Ç–∞–ø“õ—ã —ñ—Å–∫–µ “õ–æ—Å—É
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedData();
            checkQRCode();
            
            // QR –±”©–ª—ñ–º—ñ –∫”©—Ä—Å–µ—Ç—ñ–ª–≥–µ–Ω –±–æ–ª—Å–∞, QR –∫–æ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è–ª–∞—É
            const qrTab = document.getElementById('qrTab');
            if (qrTab && qrTab.classList.contains('active')) {
                setTimeout(() => {
                    generateQRCode();
                }, 500);
            }
        });
        
        // URL ”©–∑–≥–µ—Ä—ñ—Å—ñ–Ω —Ç—ã“£–¥–∞—É (QR —Å–∫–∞–Ω–µ—Ä–ª–µ—É “Ø—à—ñ–Ω)
        window.addEventListener('popstate', checkQRCode);
        
        // localStorage ”©–∑–≥–µ—Ä—ñ—Å—Ç–µ—Ä—ñ–Ω —Ç—ã“£–¥–∞—É
        window.addEventListener('storage', checkForNewVerifications);
        
        // –ñ–∞“£–∞ —Ä–∞—Å—Ç–∞—É–ª–∞—Ä–¥—ã —Ç–µ–∫—Å–µ—Ä—É
        setInterval(checkForNewVerifications, 500);
        
        // –ë–µ—Ç—Ç—ñ –∂–∞“£–∞—Ä—Ç“õ–∞–Ω–¥–∞ URL —Ç–µ–∫—Å–µ—Ä—É
        setInterval(checkQRCode, 1000);
        
        // “ö–æ—Å—ã–º—à–∞ —Ç–µ–∫—Å–µ—Ä—É –º–µ—Ö–∞–Ω–∏–∑–º—ñ
        let lastCheckTime = 0;
        setInterval(() => {
            const verificationTime = localStorage.getItem('verificationTime');
            if (verificationTime && parseInt(verificationTime) > lastCheckTime) {
                lastCheckTime = parseInt(verificationTime);
                checkForNewVerifications();
            }
        }, 100);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'985cb2c58443ecf1',t:'MTc1ODk5MzkwNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
