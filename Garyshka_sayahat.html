<!doctype html>
<html lang="kk">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è ”ô–ª–µ–º—ñ–Ω–µ —Å–∞—è—Ö–∞—Ç</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100%;
      width: 100%;
    }

    .game-container {
      width: 100%;
      min-height: 100%;
      padding: 3% 5%;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .header {
      text-align: center;
      color: white;
      margin-bottom: 3%;
    }

    .header h1 {
      font-size: 3em;
      margin: 0 0 1% 0;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .header p {
      font-size: 1.2em;
      margin: 0;
      opacity: 0.95;
    }

    .score-board {
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 2% 4%;
      margin-bottom: 3%;
      color: white;
      font-size: 1.3em;
      font-weight: bold;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .tour-container {
      background: white;
      border-radius: 20px;
      padding: 4%;
      width: 90%;
      max-width: 900px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
      margin-bottom: 3%;
    }

    .tour-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 3%;
      padding-bottom: 2%;
      border-bottom: 3px solid #667eea;
    }

    .tour-number {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5em;
      font-weight: bold;
      flex-shrink: 0;
    }

    .tour-title {
      font-size: 1.8em;
      font-weight: bold;
      color: #333;
      margin: 0;
    }

    .question-block {
      background: #f8f9fa;
      padding: 3%;
      border-radius: 12px;
      margin-bottom: 2.5%;
      border-left: 5px solid #667eea;
    }

    .question-text {
      font-size: 1.2em;
      color: #333;
      margin-bottom: 2%;
      font-weight: 600;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .option {
      background: white;
      padding: 3% 4%;
      border-radius: 10px;
      border: 2px solid #e0e0e0;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1.05em;
    }

    .option:hover {
      border-color: #667eea;
      transform: translateX(5px);
      box-shadow: 0 4px 12px rgba(102,126,234,0.2);
    }

    .option.selected {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    .option.correct {
      background: #4caf50;
      color: white;
      border-color: #4caf50;
    }

    .option.wrong {
      background: #f44336;
      color: white;
      border-color: #f44336;
    }

    .match-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 3%;
      margin-top: 2%;
    }

    .match-column h3 {
      color: #667eea;
      margin-bottom: 2%;
      font-size: 1.3em;
    }

    .match-item {
      background: white;
      padding: 3% 4%;
      border-radius: 10px;
      border: 2px solid #e0e0e0;
      margin-bottom: 2%;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .match-item:hover {
      border-color: #667eea;
      box-shadow: 0 4px 12px rgba(102,126,234,0.2);
    }

    .match-item.selected {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    .match-item.matched {
      background: #4caf50;
      color: white;
      border-color: #4caf50;
      pointer-events: none;
    }

    .problem-block {
      background: #fff3e0;
      padding: 3%;
      border-radius: 12px;
      margin-bottom: 2.5%;
      border-left: 5px solid #ff9800;
    }

    .formula {
      background: #f5f5f5;
      padding: 2%;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 1.1em;
      margin: 2% 0;
      text-align: center;
    }

    .simulation-controls {
      background: #e3f2fd;
      padding: 3%;
      border-radius: 12px;
      margin-bottom: 2.5%;
    }

    .slider-container {
      margin: 2.5% 0;
    }

    .slider-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1%;
      font-weight: 600;
      color: #333;
    }

    input[type="range"] {
      width: 100%;
      height: 8px;
      border-radius: 5px;
      background: #d3d3d3;
      outline: none;
      -webkit-appearance: none;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #667eea;
      cursor: pointer;
    }

    .result-display {
      background: white;
      padding: 2.5%;
      border-radius: 10px;
      margin-top: 2%;
      font-size: 1.2em;
      text-align: center;
      font-weight: bold;
      color: #667eea;
    }

    .btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 3% 6%;
      border-radius: 25px;
      font-size: 1.1em;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(102,126,234,0.3);
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102,126,234,0.4);
    }

    .btn:disabled {
      background: #cccccc;
      cursor: not-allowed;
      transform: none;
    }

    .btn-container {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 3%;
    }

    .scenario-card {
      background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
      padding: 3%;
      border-radius: 12px;
      margin-bottom: 2%;
      cursor: pointer;
      border: 2px solid transparent;
      transition: all 0.3s ease;
    }

    .scenario-card:hover {
      border-color: #667eea;
      box-shadow: 0 4px 15px rgba(102,126,234,0.2);
    }

    .scenario-card.selected {
      border-color: #667eea;
      background: linear-gradient(135deg, #667eea25 0%, #764ba225 100%);
    }

    .final-screen {
      text-align: center;
      padding: 5%;
    }

    .trophy {
      font-size: 6em;
      margin-bottom: 2%;
      animation: bounce 1s infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }

    .final-title {
      font-size: 2.5em;
      color: #667eea;
      margin-bottom: 2%;
      font-weight: bold;
    }

    .final-score {
      font-size: 3em;
      color: #333;
      margin-bottom: 3%;
      font-weight: bold;
    }

    .rank-badge {
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      padding: 2% 5%;
      border-radius: 50px;
      font-size: 1.5em;
      font-weight: bold;
      display: inline-block;
      margin-bottom: 3%;
      box-shadow: 0 4px 15px rgba(255,215,0,0.4);
    }

    .graph-container {
      background: #f5f5f5;
      padding: 3%;
      border-radius: 12px;
      margin: 2% 0;
      text-align: center;
    }

    .graph-svg {
      max-width: 100%;
      height: auto;
    }

    .mistake-item {
      background: #ffebee;
      padding: 2.5%;
      border-radius: 10px;
      margin-bottom: 2%;
      border-left: 4px solid #f44336;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .mistake-item:hover {
      box-shadow: 0 4px 12px rgba(244,67,54,0.2);
    }

    .mistake-item.selected {
      background: #f44336;
      color: white;
    }

    .comic-panel {
      background: #fff9c4;
      padding: 3%;
      border-radius: 12px;
      border: 3px solid #333;
      margin: 2% 0;
    }

    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @media (max-width: 768px) {
      .header h1 {
        font-size: 2em;
      }
      
      .match-container {
        grid-template-columns: 1fr;
      }
      
      .tour-title {
        font-size: 1.4em;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="game-container">
   <div class="header">
    <h1 id="game-title">üåç –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è ”ô–ª–µ–º—ñ–Ω–µ —Å–∞—è—Ö–∞—Ç üöÄ</h1>
    <p id="welcome-text">–ë“Ø–∫—ñ–ª ”ô–ª–µ–º–¥—ñ–∫ —Ç–∞—Ä—Ç—ã–ª—ã—Å –∑–∞“£—ã —Ç—É—Ä–∞–ª—ã –±—ñ–ª—ñ–º–¥–µ—Ä—ñ“£–¥—ñ —Ç–µ–∫—Å–µ—Ä!</p>
   </div>
   <div class="score-board">
    ‚≠ê “∞–ø–∞–π: <span id="total-score">0</span> / 59
   </div>
   <div id="game-content"></div>
  </div>
  <script>
    const defaultConfig = {
      game_title: "üåç –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è ”ô–ª–µ–º—ñ–Ω–µ —Å–∞—è—Ö–∞—Ç üöÄ",
      welcome_text: "–ë“Ø–∫—ñ–ª ”ô–ª–µ–º–¥—ñ–∫ —Ç–∞—Ä—Ç—ã–ª—ã—Å –∑–∞“£—ã —Ç—É—Ä–∞–ª—ã –±—ñ–ª—ñ–º–¥–µ—Ä—ñ“£–¥—ñ —Ç–µ–∫—Å–µ—Ä!"
    };

    let currentTour = 0;
    let totalScore = 0;
    let tourScores = [];

    const tours = [
      {
        title: "–í–ò–ö–¢–û–†–ò–ù–ê",
        emoji: "üìö",
        type: "quiz",
        maxScore: 14,
        questions: [
          {
            q: "–ë“Ø–∫—ñ–ª ”ô–ª–µ–º–¥—ñ–∫ —Ç–∞—Ä—Ç—ã–ª—ã—Å –∑–∞“£—ã–Ω –∫—ñ–º –∞—à—Ç—ã?",
            options: ["–ò—Å–∞–∞–∫ –ù—å—é—Ç–æ–Ω", "–ê–ª—å–±–µ—Ä—Ç –≠–π–Ω—à—Ç–µ–π–Ω", "–ì–∞–ª–∏–ª–µ–æ –ì–∞–ª–∏–ª–µ–π", "–ò–æ–≥–∞–Ω–Ω –ö–µ–ø–ª–µ—Ä"],
            correct: 0
          },
          {
            q: "–¢–∞—Ä—Ç—ã–ª—ã—Å –∫“Ø—à—ñ –¥–µ–Ω–µ–Ω—ñ“£ –º–∞—Å—Å–∞—Å—ã–Ω–∞ “õ–∞–ª–∞–π —Ç”ô—É–µ–ª–¥—ñ?",
            options: ["–ö–µ—Ä—ñ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª", "–¢”ô—É–µ–ª–¥—ñ –µ–º–µ—Å", "–¢—É—Ä–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª", "–ö–≤–∞–¥—Ä–∞—Ç“õ–∞ —Ç—É—Ä–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª"],
            correct: 2
          },
          {
            q: "–¢–∞—Ä—Ç—ã–ª—ã—Å –∫“Ø—à—ñ –¥–µ–Ω–µ –∞—Ä–∞—Å—ã–Ω–¥–∞“ì—ã “õ–∞—à—ã“õ—Ç—ã“õ“õ–∞ “õ–∞–ª–∞–π —Ç”ô—É–µ–ª–¥—ñ?",
            options: ["–¢—É—Ä–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª", "–ö–µ—Ä—ñ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª", "–ö–≤–∞–¥—Ä–∞—Ç“õ–∞ –∫–µ—Ä—ñ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª", "–¢”ô—É–µ–ª–¥—ñ –µ–º–µ—Å"],
            correct: 2
          },
          {
            q: "–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è–ª—ã“õ —Ç“±—Ä–∞“õ—Ç—ã G-–Ω—ã“£ –º”ô–Ω—ñ —à–∞–º–∞–º–µ–Ω “õ–∞–Ω—à–∞?",
            options: ["9.8 –º/—Å¬≤", "3√ó10‚Å∏ –º/—Å", "6.67√ó10‚Åª¬π¬π –ù¬∑–º¬≤/–∫–≥¬≤", "1.6√ó10‚Åª¬π‚Åπ –ö–ª"],
            correct: 2
          },
          {
            q: "–ñ–µ—Ä –±–µ—Ç—ñ–Ω–¥–µ–≥—ñ –µ—Ä–∫—ñ–Ω —Ç“Ø—Å—É “Ø–¥–µ—É—ñ —à–∞–º–∞–º–µ–Ω –Ω–µ–≥–µ —Ç–µ“£?",
            options: ["10 –º/—Å¬≤", "9.8 –º/—Å¬≤", "8 –º/—Å¬≤", "11.2 –º/—Å¬≤"],
            correct: 1
          },
          {
            q: "–ï–∫—ñ –¥–µ–Ω–µ–Ω—ñ“£ –∞—Ä–∞—Å—ã–Ω–¥–∞“ì—ã “õ–∞—à—ã“õ—Ç—ã“õ 2 –µ—Å–µ –∞—Ä—Ç—Å–∞, —Ç–∞—Ä—Ç—ã–ª—ã—Å –∫“Ø—à—ñ “õ–∞–ª–∞–π ”©–∑–≥–µ—Ä–µ–¥—ñ?",
            options: ["2 –µ—Å–µ –∞—Ä—Ç–∞–¥—ã", "2 –µ—Å–µ –∫–µ–º–∏–¥—ñ", "4 –µ—Å–µ –∞—Ä—Ç–∞–¥—ã", "4 –µ—Å–µ –∫–µ–º–∏–¥—ñ"],
            correct: 3
          },
          {
            q: "–¢–∞—Ä—Ç—ã–ª—ã—Å –∫“Ø—à—ñ “õ–∞–Ω–¥–∞–π –∫“Ø—à —Ç“Ø—Ä—ñ–Ω–µ –∂–∞—Ç–∞–¥—ã?",
            options: ["“Æ–π–∫–µ–ª—ñ—Å –∫“Ø—à—ñ", "–°–µ—Ä–ø—ñ–º–¥—ñ–ª—ñ–∫ –∫“Ø—à—ñ", "”®—Ä—ñ—Å –∫“Ø—à—ñ", "–Ø–¥—Ä–æ–ª—ã“õ –∫“Ø—à"],
            correct: 2
          }
        ]
      },
      {
        title: "–°”ò–ô–ö–ï–°–¢–ï–ù–î–Ü–†–£",
        emoji: "üîó",
        type: "matching",
        maxScore: 9,
        sets: [
          {
            title: "–§–æ—Ä–º—É–ª–∞–ª–∞—Ä –º–µ–Ω —Ç“Ø—Å—ñ–Ω–¥—ñ—Ä–º–µ–ª–µ—Ä",
            left: ["F = G(m‚ÇÅm‚ÇÇ)/r¬≤", "g = GM/R¬≤", "v = ‚àö(GM/r)"],
            right: ["–¢–∞—Ä—Ç—ã–ª—ã—Å –∫“Ø—à—ñ —Ñ–æ—Ä–º—É–ª–∞—Å—ã", "–ï—Ä–∫—ñ–Ω —Ç“Ø—Å—É “Ø–¥–µ—É—ñ", "–û—Ä–±–∏—Ç–∞–ª—ã“õ –∂—ã–ª–¥–∞–º–¥—ã“õ"]
          },
          {
            title: "–§–∏–∑–∏–∫—Ç–µ—Ä –º–µ–Ω –∂–∞“£–∞–ª—ã“õ—Ç–∞—Ä",
            left: ["–ò—Å–∞–∞–∫ –ù—å—é—Ç–æ–Ω", "–ê–ª—å–±–µ—Ä—Ç –≠–π–Ω—à—Ç–µ–π–Ω", "–ò–æ–≥–∞–Ω–Ω –ö–µ–ø–ª–µ—Ä"],
            right: ["–¢–∞—Ä—Ç—ã–ª—ã—Å –∑–∞“£—ã", "–ñ–∞–ª–ø—ã —Å–∞–ª—ã—Å—Ç—ã—Ä–º–∞–ª—ã–ª—ã“õ —Ç–µ–æ—Ä–∏—è—Å—ã", "–ü–ª–∞–Ω–µ—Ç–∞–ª–∞—Ä “õ–æ–∑“ì–∞–ª—ã—Å—ã–Ω—ã“£ –∑–∞“£–¥–∞—Ä—ã"]
          },
          {
            title: "–®–∞–º–∞–ª–∞—Ä –º–µ–Ω ”©–ª—à–µ–º –±—ñ—Ä–ª—ñ–∫—Ç–µ—Ä—ñ",
            left: ["–ö“Ø—à", "–ú–∞—Å—Å–∞", "“ö–∞—à—ã“õ—Ç—ã“õ"],
            right: ["–ù—å—é—Ç–æ–Ω (–ù)", "–ö–∏–ª–æ–≥—Ä–∞–º–º (–∫–≥)", "–ú–µ—Ç—Ä (–º)"]
          }
        ]
      },
      {
        title: "–ï–°–ï–ü–¢–ï–†",
        emoji: "üßÆ",
        type: "problems",
        maxScore: 15,
        problems: [
          {
            difficulty: "–ñ–µ“£—ñ–ª",
            text: "–ú–∞—Å—Å–∞—Å—ã 5 –∫–≥ –¥–µ–Ω–µ –ñ–µ—Ä –±–µ—Ç—ñ–Ω–¥–µ. –û–Ω—ã“£ —Å–∞–ª–º–∞“ì—ã–Ω —Ç–∞–±—ã“£—ã–∑. (g = 10 –º/—Å¬≤)",
            solution: "P = mg = 5 –∫–≥ √ó 10 –º/—Å¬≤ = 50 –ù",
            answer: "50"
          },
          {
            difficulty: "–û—Ä—Ç–∞—à–∞",
            text: "–ú–∞—Å—Å–∞–ª–∞—Ä—ã 10 –∫–≥ –∂”ô–Ω–µ 20 –∫–≥ –µ–∫—ñ –¥–µ–Ω–µ 2 –º “õ–∞—à—ã“õ—Ç—ã“õ—Ç–∞ –æ—Ä–Ω–∞–ª–∞—Å“õ–∞–Ω. –û–ª–∞—Ä–¥—ã“£ –∞—Ä–∞—Å—ã–Ω–¥–∞“ì—ã —Ç–∞—Ä—Ç—ã–ª—ã—Å –∫“Ø—à—ñ–Ω –µ—Å–µ–ø—Ç–µ“£—ñ–∑. (G = 6.67√ó10‚Åª¬π¬π –ù¬∑–º¬≤/–∫–≥¬≤)",
            solution: "F = G(m‚ÇÅm‚ÇÇ)/r¬≤ = 6.67√ó10‚Åª¬π¬π √ó (10√ó20)/2¬≤ = 6.67√ó10‚Åª¬π¬π √ó 200/4 = 3.34√ó10‚Åª‚Åπ –ù",
            answer: "3.34*10^-9"
          },
          {
            difficulty: "“ö–∏—ã–Ω",
            text: "–ñ–µ—Ä –±–µ—Ç—ñ–Ω–µ–Ω 1000 –∫–º –±–∏—ñ–∫—Ç—ñ–∫—Ç–µ –µ—Ä–∫—ñ–Ω —Ç“Ø—Å—É “Ø–¥–µ—É—ñ–Ω —Ç–∞–±—ã“£—ã–∑. –ñ–µ—Ä–¥—ñ“£ —Ä–∞–¥–∏—É—Å—ã R = 6371 –∫–º, g‚ÇÄ = 10 –º/—Å¬≤. –ñ–∞—É–∞–ø—Ç—ã –±“Ø—Ç—ñ–Ω —Å–∞–Ω–º–µ–Ω –∂–∞–∑—ã“£—ã–∑ (–º/—Å¬≤)",
            solution: "g = 10 √ó (6371/(6371+1000))¬≤ = 10 √ó (6371/7371)¬≤ = 10 √ó 0.748 = 7.48 ‚âà 7 –º/—Å¬≤",
            answer: "7"
          }
        ]
      },
      {
        title: "–í–ò–ó–£–ê–õ–î–´ –¢–£–†",
        emoji: "üìä",
        type: "visual",
        maxScore: 9,
        tasks: [
          {
            question: "“ö–∞–π –≥—Ä–∞—Ñ–∏–∫ —Ç–∞—Ä—Ç—ã–ª—ã—Å –∫“Ø—à—ñ–Ω—ñ“£ “õ–∞—à—ã“õ—Ç—ã“õ“õ–∞ (r) —Ç”ô—É–µ–ª–¥—ñ–≥—ñ–Ω –¥“±—Ä—ã—Å –∫”©—Ä—Å–µ—Ç–µ–¥—ñ?",
            graphs: ["graph1", "graph2", "graph3"],
            correct: 1,
            description: "F ~ 1/r¬≤ –∑–∞“£—ã–Ω–∞ —Å”ô–π–∫–µ—Å –≥–∏–ø–µ—Ä–±–æ–ª–∞"
          },
          {
            question: "–ü–ª–∞–Ω–µ—Ç–∞–Ω—ã“£ –æ—Ä–±–∏—Ç–∞–ª—ã“õ –∂—ã–ª–¥–∞–º–¥—ã“ì—ã –æ–Ω—ã“£ –ö“Ø–Ω–Ω–µ–Ω “õ–∞—à—ã“õ—Ç—ã“ì—ã–Ω–∞ “õ–∞–ª–∞–π —Ç”ô—É–µ–ª–¥—ñ?",
            graphs: ["increasing", "decreasing", "constant"],
            correct: 1,
            description: "“ö–∞—à—ã“õ—Ç—ã“õ –∞—Ä—Ç“õ–∞–Ω —Å–∞–π—ã–Ω –∂—ã–ª–¥–∞–º–¥—ã“õ –∞–∑–∞—è–¥—ã"
          },
          {
            question: "–ñ–µ—Ä –±–µ—Ç—ñ–Ω–µ–Ω –±–∏—ñ–∫—Ç—ñ–∫ –∞—Ä—Ç“õ–∞–Ω —Å–∞–π—ã–Ω g “Ø–¥–µ—É—ñ “õ–∞–ª–∞–π ”©–∑–≥–µ—Ä–µ–¥—ñ?",
            graphs: ["increases", "decreases", "stays"],
            correct: 1,
            description: "–ë–∏—ñ–∫—Ç—ñ–∫ –∞—Ä—Ç“õ–∞–Ω —Å–∞–π—ã–Ω g –∞–∑–∞—è–¥—ã"
          }
        ]
      },
      {
        title: "–°–£–ü–ï–†-–§–ò–ù–ê–õ",
        emoji: "üß†",
        type: "superfinal",
        maxScore: 12,
        sections: [
          {
            type: "logic",
            title: "–õ–æ–≥–∏–∫–∞–ª—ã“õ —Å“±—Ä–∞“õ—Ç–∞—Ä",
            questions: [
              {
                q: "–ï–∫—ñ –¥–µ–Ω–µ –±—ñ—Ä–¥–µ–π –∫“Ø—à–ø–µ–Ω —Ç–∞—Ä—Ç—ã–ª–∞–¥—ã. “ö–∞–π—Å—ã—Å—ã –∂—ã–ª–¥–∞–º—ã—Ä–∞“õ “õ–æ–∑“ì–∞–ª–∞–¥—ã?",
                options: ["–ê—É—ã—Ä –¥–µ–Ω–µ", "–ñ–µ“£—ñ–ª –¥–µ–Ω–µ", "–ï–∫–µ—É—ñ –¥–µ –±—ñ—Ä–¥–µ–π", "“ö–æ–∑“ì–∞–ª–º–∞–π–¥—ã"],
                correct: 1,
                explanation: "F = ma, —Å–æ–Ω–¥—ã“õ—Ç–∞–Ω –∞ = F/m. –ö—ñ—à—ñ –º–∞—Å—Å–∞–¥–∞ “Ø–¥–µ—É “Ø–ª–∫–µ–Ω"
              },
              {
                q: "–ù–µ–ª—ñ–∫—Ç–µ–Ω “ì–∞—Ä—ã—à—Ç–∞ —Ç–∞—Ä—Ç—ã–ª—ã—Å –±–∞—Ä, –±—ñ—Ä–∞“õ —Å–∞–ª–º–∞“õ—Å—ã–∑–¥—ã“õ —Å–µ–∑—ñ–ª–µ–¥—ñ?",
                options: ["–¢–∞—Ä—Ç—ã–ª—ã—Å –∂–æ“õ", "–ï—Ä–∫—ñ–Ω —Ç“Ø—Å—É –∫“Ø–π—ñ", "–ê—É–∞ –∂–æ“õ", "“ö—ã—Å—ã–º –∂–æ“õ"],
                correct: 1,
                explanation: "–û—Ä–±–∏—Ç–∞–¥–∞ –¥–µ–Ω–µ “Ø–∑–¥—ñ–∫—Å—ñ–∑ –µ—Ä–∫—ñ–Ω —Ç“Ø—Å—É –∫“Ø–π—ñ–Ω–¥–µ"
              },
              {
                q: "–ñ–µ—Ä–¥—ñ“£ —ñ—à—ñ–Ω–¥–µ —Ç–∞—Ä—Ç—ã–ª—ã—Å –∫“Ø—à—ñ “õ–∞–ª–∞–π ”©–∑–≥–µ—Ä–µ–¥—ñ?",
                options: ["–ê—Ä—Ç–∞–¥—ã", "–ö–µ–º–∏–¥—ñ", "–¢“±—Ä–∞“õ—Ç—ã “õ–∞–ª–∞–¥—ã", "–ù”©–ª–≥–µ –∞–π–Ω–∞–ª–∞–¥—ã"],
                correct: 1,
                explanation: "–û—Ä—Ç–∞–ª—ã“õ“õ–∞ “õ–∞—Ä–∞–π –∫–µ–º–∏–¥—ñ, –¥”ô–ª –æ—Ä—Ç–∞–¥–∞ –Ω”©–ª"
              }
            ]
          },
          {
            type: "mistakes",
            title: "“ö–∞—Ç–µ —Ç–∞–ø",
            mistakes: [
              {
                text: "F = G(m‚ÇÅ+m‚ÇÇ)/r¬≤",
                isWrong: true,
                explanation: "–î“±—Ä—ã—Å —Ñ–æ—Ä–º—É–ª–∞: F = G(m‚ÇÅ√óm‚ÇÇ)/r¬≤"
              },
              {
                text: "–¢–∞—Ä—Ç—ã–ª—ã—Å —Ç–µ–∫ –∞—É—ã—Ä –¥–µ–Ω–µ–ª–µ—Ä –∞—Ä–∞—Å—ã–Ω–¥–∞ –±–æ–ª–∞–¥—ã",
                isWrong: true,
                explanation: "–¢–∞—Ä—Ç—ã–ª—ã—Å –±–∞—Ä–ª—ã“õ –¥–µ–Ω–µ–ª–µ—Ä –∞—Ä–∞—Å—ã–Ω–¥–∞ –±–æ–ª–∞–¥—ã"
              },
              {
                text: "“ö–∞—à—ã“õ—Ç—ã“õ 2 –µ—Å–µ –∞—Ä—Ç—Å–∞, –∫“Ø—à 2 –µ—Å–µ –∫–µ–º–∏–¥—ñ",
                isWrong: true,
                explanation: "“ö–∞—à—ã“õ—Ç—ã“õ 2 –µ—Å–µ –∞—Ä—Ç—Å–∞, –∫“Ø—à 4 –µ—Å–µ –∫–µ–º–∏–¥—ñ (1/r¬≤)"
              }
            ]
          },
          {
            type: "comic",
            title: "–ú–∏–Ω–∏-–∫–æ–º–∏–∫—Å",
            story: "üõ∞Ô∏è –°–ø—É—Ç–Ω–∏–∫ –æ—Ä–±–∏—Ç–∞–¥–∞–Ω —à—ã“ì—ã–ø, –ñ–µ—Ä–≥–µ “õ“±–ª–∞–¥—ã!",
            question: "–ù–µ–ª—ñ–∫—Ç–µ–Ω —Å–ø—É—Ç–Ω–∏–∫ –æ—Ä–±–∏—Ç–∞–¥–∞–Ω —à—ã“ì—ã–ø –∫–µ—Ç—Ç—ñ?",
            options: [
              "–ñ—ã–ª–¥–∞–º–¥—ã“ì—ã —Ç—ã–º “Ø–ª–∫–µ–Ω –±–æ–ª–¥—ã",
              "–ñ—ã–ª–¥–∞–º–¥—ã“ì—ã —Ç—ã–º –∞–∑ –±–æ–ª–¥—ã",
              "–ú–∞—Å—Å–∞—Å—ã —Ç—ã–º “Ø–ª–∫–µ–Ω –±–æ–ª–¥—ã"
            ],
            correct: 1,
            explanation: "–û—Ä–±–∏—Ç–∞–ª—ã“õ –∂—ã–ª–¥–∞–º–¥—ã“õ –∂–µ—Ç–∫—ñ–ª—ñ–∫—Å—ñ–∑ –±–æ–ª—Å–∞, —Å–ø—É—Ç–Ω–∏–∫ “õ“±–ª–∞–π–¥—ã"
          }
        ]
      }
    ];

    async function onConfigChange(config) {
      const gameTitle = config.game_title || defaultConfig.game_title;
      const welcomeText = config.welcome_text || defaultConfig.welcome_text;
      
      document.getElementById('game-title').textContent = gameTitle;
      document.getElementById('welcome-text').textContent = welcomeText;
    }

    const dataHandler = {
      onDataChanged(data) {
        // Just store the data, no automatic processing needed
      }
    };

    async function initSDKs() {
      if (window.dataSdk) {
        const initResult = await window.dataSdk.init(dataHandler);
        if (!initResult.isOk) {
          console.error("Failed to initialize data SDK");
        }
      }

      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities: (config) => ({
            recolorables: [],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined
          }),
          mapToEditPanelValues: (config) => new Map([
            ["game_title", config.game_title || defaultConfig.game_title],
            ["welcome_text", config.welcome_text || defaultConfig.welcome_text]
          ])
        });
      }
    }

    function renderTour(tourIndex) {
      const tour = tours[tourIndex];
      const content = document.getElementById('game-content');
      
      let html = `
        <div class="tour-container">
          <div class="tour-header">
            <div class="tour-number">${tourIndex + 1}</div>
            <h2 class="tour-title">${tour.emoji} ${tour.title}</h2>
          </div>
      `;

      if (tour.type === 'quiz') {
        tour.questions.forEach((q, i) => {
          html += `
            <div class="question-block">
              <div class="question-text">${i + 1}. ${q.q}</div>
              <div class="options">
                ${q.options.map((opt, oi) => `
                  <div class="option" data-question="${i}" data-option="${oi}">
                    ${String.fromCharCode(65 + oi)}. ${opt}
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
      } else if (tour.type === 'matching') {
        tour.sets.forEach((set, si) => {
          html += `
            <div class="question-block">
              <h3 style="color: #667eea; margin-bottom: 2%;">${set.title}</h3>
              <div class="match-container">
                <div class="match-column">
                  <h4>–í–∞—Ä–∏–∞–Ω—Ç—Ç–∞—Ä:</h4>
                  ${set.right.map((item, i) => `
                    <div class="match-item" data-set="${si}" data-side="right" data-index="${i}">
                      ${item}
                    </div>
                  `).join('')}
                </div>
                <div class="match-column">
                  <h4>–°”ô–π–∫–µ—Å—Ç–µ–Ω–¥—ñ—Ä—É:</h4>
                  ${set.left.map((item, i) => `
                    <div class="match-item" data-set="${si}" data-side="left" data-index="${i}">
                      ${item}
                    </div>
                  `).join('')}
                </div>
              </div>
            </div>
          `;
        });
      } else if (tour.type === 'problems') {
        tour.problems.forEach((p, i) => {
          html += `
            <div class="problem-block">
              <h3 style="color: #ff9800;">üìù ${p.difficulty} –µ—Å–µ–ø</h3>
              <div class="question-text">${p.text}</div>
              <div style="margin-top: 2%;">
                <label for="problem-answer-${i}" style="font-weight: bold; color: #333; display: block; margin-bottom: 1%;">
                  –ñ–∞—É–∞–±—ã“£—ã–∑:
                </label>
                <input 
                  type="text" 
                  id="problem-answer-${i}" 
                  placeholder="–ñ–∞—É–∞–ø—Ç—ã –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑"
                  style="width: 100%; padding: 2%; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1.1em; box-sizing: border-box;"
                  data-problem="${i}"
                >
              </div>
              <div id="problem-feedback-${i}" style="display: none; margin-top: 2%; padding: 2%; border-radius: 8px;"></div>
            </div>
          `;
        });
      } else if (tour.type === 'visual') {
        tour.tasks.forEach((task, i) => {
          html += `
            <div class="question-block">
              <div class="question-text">${i + 1}. ${task.question}</div>
              <div class="graph-container">
                ${renderGraph(task.graphs[0], i, 0)}
                ${renderGraph(task.graphs[1], i, 1)}
                ${renderGraph(task.graphs[2], i, 2)}
              </div>
              <div class="options">
                ${task.graphs.map((g, gi) => `
                  <div class="option" data-visual="${i}" data-option="${gi}">
                    –ì—Ä–∞—Ñ–∏–∫ ${gi + 1}
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
      } else if (tour.type === 'superfinal') {
        tour.sections.forEach(section => {
          if (section.type === 'logic') {
            html += `<h3 style="color: #667eea; margin: 3% 0 2% 0;">üß† ${section.title}</h3>`;
            section.questions.forEach((q, i) => {
              html += `
                <div class="question-block">
                  <div class="question-text">${i + 1}. ${q.q}</div>
                  <div class="options">
                    ${q.options.map((opt, oi) => `
                      <div class="option" data-logic="${i}" data-option="${oi}">
                        ${String.fromCharCode(65 + oi)}. ${opt}
                      </div>
                    `).join('')}
                  </div>
                  <div id="logic-explanation-${i}" style="display: none; margin-top: 2%; padding: 2%; background: #e3f2fd; border-radius: 8px; color: #1976d2;">
                    üí° ${q.explanation}
                  </div>
                </div>
              `;
            });
          } else if (section.type === 'mistakes') {
            html += `
              <h3 style="color: #f44336; margin: 3% 0 2% 0;">‚ùå ${section.title}</h3>
              <p style="color: #666; margin-bottom: 2%;">“ö–∞—Ç–µ —Ç“±–∂—ã—Ä—ã–º–¥–∞—Ä–¥—ã —Ç–∞“£–¥–∞“£—ã–∑:</p>
            `;
            section.mistakes.forEach((m, i) => {
              html += `
                <div class="mistake-item" data-mistake="${i}">
                  ${m.text}
                </div>
              `;
            });
          } else if (section.type === 'comic') {
            html += `
              <h3 style="color: #ff9800; margin: 3% 0 2% 0;">üìñ ${section.title}</h3>
              <div class="comic-panel">
                <p style="font-size: 1.3em; margin-bottom: 2%; text-align: center;">${section.story}</p>
                <div class="question-text">${section.question}</div>
                <div class="options">
                  ${section.options.map((opt, oi) => `
                    <div class="option" data-comic="0" data-option="${oi}">
                      ${String.fromCharCode(65 + oi)}. ${opt}
                    </div>
                  `).join('')}
                </div>
                <div id="comic-explanation" style="display: none; margin-top: 2%; padding: 2%; background: #fff3e0; border-radius: 8px; color: #f57c00;">
                  üí° ${section.explanation}
                </div>
              </div>
            `;
          }
        });
      }

      html += `
          <div class="btn-container">
            <button class="btn" onclick="checkTourAnswers(${tourIndex})" id="check-btn-${tourIndex}">
              –¢–µ–∫—Å–µ—Ä—É
            </button>
            <button class="btn" onclick="nextTour()" id="next-btn-${tourIndex}" style="display: none;">
              –ö–µ–ª–µ—Å—ñ —Ç—É—Ä ‚Üí
            </button>
          </div>
        </div>
      `;

      content.innerHTML = html;

      setupEventListeners(tourIndex);
    }

    function renderGraph(type, taskIndex, graphIndex) {
      const graphs = {
        'graph1': '<svg class="graph-svg" width="150" height="100" viewBox="0 0 150 100"><line x1="20" y1="80" x2="130" y2="80" stroke="#333" stroke-width="2"/><line x1="20" y1="80" x2="20" y2="10" stroke="#333" stroke-width="2"/><path d="M 20 80 L 130 20" stroke="#667eea" stroke-width="3" fill="none"/><text x="75" y="95" font-size="10" text-anchor="middle">r</text><text x="10" y="45" font-size="10" text-anchor="middle">F</text></svg>',
        'graph2': '<svg class="graph-svg" width="150" height="100" viewBox="0 0 150 100"><line x1="20" y1="80" x2="130" y2="80" stroke="#333" stroke-width="2"/><line x1="20" y1="80" x2="20" y2="10" stroke="#333" stroke-width="2"/><path d="M 20 20 Q 75 50 130 80" stroke="#667eea" stroke-width="3" fill="none"/><text x="75" y="95" font-size="10" text-anchor="middle">r</text><text x="10" y="45" font-size="10" text-anchor="middle">F</text></svg>',
        'graph3': '<svg class="graph-svg" width="150" height="100" viewBox="0 0 150 100"><line x1="20" y1="80" x2="130" y2="80" stroke="#333" stroke-width="2"/><line x1="20" y1="80" x2="20" y2="10" stroke="#333" stroke-width="2"/><path d="M 20 40 L 130 40" stroke="#667eea" stroke-width="3" fill="none"/><text x="75" y="95" font-size="10" text-anchor="middle">r</text><text x="10" y="45" font-size="10" text-anchor="middle">F</text></svg>',
        'increasing': '<svg class="graph-svg" width="150" height="100" viewBox="0 0 150 100"><line x1="20" y1="80" x2="130" y2="80" stroke="#333" stroke-width="2"/><line x1="20" y1="80" x2="20" y2="10" stroke="#333" stroke-width="2"/><path d="M 20 80 L 130 20" stroke="#4caf50" stroke-width="3" fill="none"/></svg>',
        'decreasing': '<svg class="graph-svg" width="150" height="100" viewBox="0 0 150 100"><line x1="20" y1="80" x2="130" y2="80" stroke="#333" stroke-width="2"/><line x1="20" y1="80" x2="20" y2="10" stroke="#333" stroke-width="2"/><path d="M 20 20 L 130 80" stroke="#4caf50" stroke-width="3" fill="none"/></svg>',
        'constant': '<svg class="graph-svg" width="150" height="100" viewBox="0 0 150 100"><line x1="20" y1="80" x2="130" y2="80" stroke="#333" stroke-width="2"/><line x1="20" y1="80" x2="20" y2="10" stroke="#333" stroke-width="2"/><path d="M 20 40 L 130 40" stroke="#4caf50" stroke-width="3" fill="none"/></svg>',
        'increases': '<svg class="graph-svg" width="150" height="100" viewBox="0 0 150 100"><line x1="20" y1="80" x2="130" y2="80" stroke="#333" stroke-width="2"/><line x1="20" y1="80" x2="20" y2="10" stroke="#333" stroke-width="2"/><path d="M 20 70 L 130 30" stroke="#f44336" stroke-width="3" fill="none"/></svg>',
        'decreases': '<svg class="graph-svg" width="150" height="100" viewBox="0 0 150 100"><line x1="20" y1="80" x2="130" y2="80" stroke="#333" stroke-width="2"/><line x1="20" y1="80" x2="20" y2="10" stroke="#333" stroke-width="2"/><path d="M 20 30 L 130 70" stroke="#f44336" stroke-width="3" fill="none"/></svg>',
        'stays': '<svg class="graph-svg" width="150" height="100" viewBox="0 0 150 100"><line x1="20" y1="80" x2="130" y2="80" stroke="#333" stroke-width="2"/><line x1="20" y1="80" x2="20" y2="10" stroke="#333" stroke-width="2"/><path d="M 20 50 L 130 50" stroke="#f44336" stroke-width="3" fill="none"/></svg>'
      };
      return graphs[type] || '';
    }

    function setupEventListeners(tourIndex) {
      const tour = tours[tourIndex];

      if (tour.type === 'quiz') {
        document.querySelectorAll('.option').forEach(opt => {
          opt.addEventListener('click', function() {
            const q = this.dataset.question;
            document.querySelectorAll(`[data-question="${q}"]`).forEach(o => 
              o.classList.remove('selected'));
            this.classList.add('selected');
          });
        });
      } else if (tour.type === 'matching') {
        let selectedRight = null;
        let selectedSet = null;

        document.querySelectorAll('.match-item').forEach(item => {
          item.addEventListener('click', function() {
            if (this.classList.contains('matched')) return;

            const set = this.dataset.set;
            const side = this.dataset.side;
            const index = this.dataset.index;

            if (side === 'right') {
              document.querySelectorAll(`[data-set="${set}"][data-side="right"]`).forEach(el => {
                el.classList.remove('selected');
              });
              selectedRight = index;
              selectedSet = set;
              this.classList.add('selected');
            } else if (side === 'left' && selectedRight !== null && selectedSet === set) {
              if (selectedRight === index) {
                this.classList.add('matched');
                document.querySelector(`[data-set="${set}"][data-side="right"][data-index="${selectedRight}"]`)
                  .classList.add('matched');
                selectedRight = null;
                selectedSet = null;
              }
            }
          });
        });
      } else if (tour.type === 'visual') {
        document.querySelectorAll('[data-visual]').forEach(opt => {
          opt.addEventListener('click', function() {
            const v = this.dataset.visual;
            document.querySelectorAll(`[data-visual="${v}"]`).forEach(o => 
              o.classList.remove('selected'));
            this.classList.add('selected');
          });
        });
      } else if (tour.type === 'superfinal') {
        document.querySelectorAll('[data-logic]').forEach(opt => {
          opt.addEventListener('click', function() {
            const l = this.dataset.logic;
            document.querySelectorAll(`[data-logic="${l}"]`).forEach(o => 
              o.classList.remove('selected'));
            this.classList.add('selected');
          });
        });

        document.querySelectorAll('[data-mistake]').forEach(item => {
          item.addEventListener('click', function() {
            this.classList.toggle('selected');
          });
        });

        document.querySelectorAll('[data-comic]').forEach(opt => {
          opt.addEventListener('click', function() {
            const c = this.dataset.comic;
            document.querySelectorAll(`[data-comic="${c}"]`).forEach(o => 
              o.classList.remove('selected'));
            this.classList.add('selected');
          });
        });
      }
    }

    function checkTourAnswers(tourIndex) {
      const tour = tours[tourIndex];
      let score = 0;

      if (tour.type === 'quiz') {
        tour.questions.forEach((q, i) => {
          const selected = document.querySelector(`[data-question="${i}"].selected`);
          if (selected) {
            const optionIndex = parseInt(selected.dataset.option);
            if (optionIndex === q.correct) {
              selected.classList.add('correct');
              score += 2;
            } else {
              selected.classList.add('wrong');
              document.querySelector(`[data-question="${i}"][data-option="${q.correct}"]`)
                .classList.add('correct');
            }
          }
        });
      } else if (tour.type === 'matching') {
        const matched = document.querySelectorAll('.match-item.matched').length / 2;
        score = matched * 3;
      } else if (tour.type === 'problems') {
        tour.problems.forEach((problem, i) => {
          const input = document.getElementById(`problem-answer-${i}`);
          const feedback = document.getElementById(`problem-feedback-${i}`);
          
          if (input && input.value.trim()) {
            const userAnswer = input.value.trim().toLowerCase();
            const correctAnswer = problem.answer.toLowerCase();
            
            feedback.style.display = 'block';
            
            if (userAnswer === correctAnswer) {
              feedback.style.background = '#d4edda';
              feedback.style.color = '#155724';
              feedback.style.border = '2px solid #c3e6cb';
              feedback.innerHTML = '‚úÖ –î“±—Ä—ã—Å –∂–∞—É–∞–ø!';
              input.style.borderColor = '#4caf50';
              score += 5;
            } else {
              feedback.style.background = '#f8d7da';
              feedback.style.color = '#721c24';
              feedback.style.border = '2px solid #f5c6cb';
              feedback.innerHTML = `‚ùå “ö–∞—Ç–µ –∂–∞—É–∞–ø. –î“±—Ä—ã—Å—ã: ${problem.answer}`;
              input.style.borderColor = '#f44336';
            }
          }
        });
      } else if (tour.type === 'visual') {
        tour.tasks.forEach((task, i) => {
          const selected = document.querySelector(`[data-visual="${i}"].selected`);
          if (selected) {
            const optionIndex = parseInt(selected.dataset.option);
            if (optionIndex === task.correct) {
              selected.classList.add('correct');
              score += 3;
            } else {
              selected.classList.add('wrong');
            }
          }
        });
      } else if (tour.type === 'superfinal') {
        const logicSection = tour.sections.find(s => s.type === 'logic');
        logicSection.questions.forEach((q, i) => {
          const selected = document.querySelector(`[data-logic="${i}"].selected`);
          if (selected) {
            const optionIndex = parseInt(selected.dataset.option);
            if (optionIndex === q.correct) {
              selected.classList.add('correct');
              score += 2;
              document.getElementById(`logic-explanation-${i}`).style.display = 'block';
            } else {
              selected.classList.add('wrong');
            }
          }
        });

        const mistakesSection = tour.sections.find(s => s.type === 'mistakes');
        const selectedMistakes = document.querySelectorAll('.mistake-item.selected');
        selectedMistakes.forEach(item => {
          const mistakeIndex = parseInt(item.dataset.mistake);
          if (mistakesSection.mistakes[mistakeIndex].isWrong) {
            score += 2;
          }
        });

        const comicSection = tour.sections.find(s => s.type === 'comic');
        const comicSelected = document.querySelector('[data-comic="0"].selected');
        if (comicSelected) {
          const optionIndex = parseInt(comicSelected.dataset.option);
          if (optionIndex === comicSection.correct) {
            comicSelected.classList.add('correct');
            score += 2;
            document.getElementById('comic-explanation').style.display = 'block';
          } else {
            comicSelected.classList.add('wrong');
          }
        }
      }

      tourScores[tourIndex] = score;
      totalScore = tourScores.reduce((a, b) => a + b, 0);
      document.getElementById('total-score').textContent = totalScore;

      document.getElementById(`check-btn-${tourIndex}`).style.display = 'none';
      document.getElementById(`next-btn-${tourIndex}`).style.display = 'inline-block';

      saveTourScore(tourIndex + 1, score);
    }

    async function saveTourScore(tourNumber, score) {
      if (window.dataSdk) {
        const btn = document.getElementById(`next-btn-${tourNumber - 1}`);
        if (btn) {
          btn.disabled = true;
          btn.innerHTML = '<span class="loading"></span>';
        }

        const result = await window.dataSdk.create({
          tour_number: tourNumber,
          score: score,
          completed_at: new Date().toISOString()
        });

        if (btn) {
          btn.disabled = false;
          btn.innerHTML = '–ö–µ–ª–µ—Å—ñ —Ç—É—Ä ‚Üí';
        }
      }
    }

    function nextTour() {
      currentTour++;
      if (currentTour < tours.length) {
        renderTour(currentTour);
        window.scrollTo({ top: 0, behavior: 'smooth' });
      } else {
        showFinalScreen();
      }
    }

    function showFinalScreen() {
      const content = document.getElementById('game-content');
      
      let rank = '';
      let trophy = 'üéñÔ∏è';
      
      if (totalScore >= 55) {
        rank = '–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è –®–µ–±–µ—Ä—ñ';
        trophy = 'üèÜ';
      } else if (totalScore >= 45) {
        rank = '“í–∞—Ä—ã—à –ó–µ—Ä—Ç—Ç–µ—É—à—ñ—Å—ñ';
        trophy = 'üåü';
      } else if (totalScore >= 30) {
        rank = '–û—Ä–±–∏—Ç–∞–ª—ã“õ –ë—ñ–ª—ñ–º–≥–µ—Ä';
        trophy = '‚≠ê';
      } else {
        rank = '–¢–∞“ì—ã –¥–∞–π—ã–Ω–¥–∞–ª—É –∫–µ—Ä–µ–∫';
        trophy = 'üìö';
      }

      content.innerHTML = `
        <div class="tour-container">
          <div class="final-screen">
            <div class="trophy">${trophy}</div>
            <div class="final-title">“ö“±—Ç—Ç—ã“õ—Ç–∞–π–º—ã–∑!</div>
            <div class="final-score">${totalScore} / 59</div>
            <div class="rank-badge">${rank}</div>
            <p style="font-size: 1.2em; color: #666; margin: 3% 0;">
              –ë“Ø–∫—ñ–ª ”ô–ª–µ–º–¥—ñ–∫ —Ç–∞—Ä—Ç—ã–ª—ã—Å –∑–∞“£—ã –±–æ–π—ã–Ω—à–∞ –±–∞—Ä–ª—ã“õ —Ç—É—Ä–ª–∞—Ä–¥—ã –∞—è“õ—Ç–∞–¥—ã“£—ã–∑! üéâ
            </p>
            <button class="btn" onclick="location.reload()" style="margin-top: 3%;">
              “ö–∞–π—Ç–∞–¥–∞–Ω –±–∞—Å—Ç–∞—É
            </button>
          </div>
        </div>
      `;
    }

    window.checkTourAnswers = checkTourAnswers;
    window.nextTour = nextTour;

    document.addEventListener('DOMContentLoaded', async () => {
      await initSDKs();
      renderTour(0);
    });
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a6d1dcf41b6ecf1',t:'MTc2NDUzNDc3MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
