<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Математика және Физика: Кешенді Тест</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- MathJax CDN for rendering LaTeX math formulas -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f7fafc; }
        .question-card { transition: all 0.3s ease; }
        .option-label {
            width: 1.5rem; height: 1.5rem; display: flex;
            align-items: center; justify-content: center;
            border-radius: 50%; background-color: #e5e7eb;
            color: #4b5563; font-weight: 600; margin-right: 0.75rem;
            flex-shrink: 0;
        }
        @keyframes pulse-red {
            0%, 100% { background-color: #ef4444; }
            50% { background-color: #fca5a5; }
        }
        .animate-pulse-custom { animation: pulse-red 1s infinite; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 sm:p-8">

    <div id="quiz-container" class="w-full max-w-4xl bg-white shadow-2xl rounded-xl p-6 sm:p-10">
        
        <h1 class="text-3xl sm:text-4xl font-extrabold text-center text-indigo-700 mb-2">
            Математика және Физика
        </h1>
        <p class="text-center text-gray-500 mb-8 sm:mb-6">
            Барлығы 37 сұрақ. (Математика + Физика)
        </p>

        <!-- Time Setup Section -->
        <div id="time-setup" class="mb-8 p-6 bg-indigo-50 border border-indigo-200 rounded-xl shadow-md text-center">
            <h2 class="text-xl font-bold text-indigo-700 mb-4">Тест уақытын белгілеңіз (минутпен)</h2>
            <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                <input type="number" id="time-input" value="30" min="5" max="180" class="w-full sm:w-40 p-3 border-2 border-indigo-300 rounded-lg text-2xl text-center font-semibold focus:outline-none focus:border-indigo-500">
                <button onclick="startQuiz()" class="w-full sm:w-auto whitespace-nowrap bg-green-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-700 transition duration-300 shadow-md">
                    Тестті Бастау
                </button>
            </div>
            <p class="text-sm text-gray-500 mt-2">Ұсынылатын уақыт: 30-40 минут.</p>
        </div>

        <!-- Timer Display -->
        <div id="timer-container" class="mb-6 p-3 bg-red-100 border border-red-400 rounded-lg shadow-md text-center hidden">
            <p class="text-lg font-bold text-red-700">
                Қалған уақыт: <span id="time-left" class="text-2xl font-extrabold ml-2">00:00</span>
            </p>
        </div>

        <div id="questions-list" class="hidden"></div>

        <div class="mt-10 flex flex-col sm:flex-row gap-4">
            <button id="submit-button" onclick="submitQuiz()" class="w-full sm:w-1/2 bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 transition duration-300 shadow-md hidden">
                Жауаптарды Тексеру
            </button>
            <button id="restart-button" onclick="restartQuiz()" class="w-full sm:w-1/2 bg-gray-300 text-gray-800 font-bold py-3 px-6 rounded-lg hover:bg-gray-400 transition duration-300 shadow-md hidden">
                Тестті Қайта Бастау
            </button>
        </div>

        <div id="results" class="mt-10 p-6 bg-gray-100 border-l-4 border-indigo-500 rounded-lg shadow-inner hidden">
            <h2 id="results-title" class="text-2xl font-bold text-gray-800 mb-4">Нәтижелер:</h2>
            <p class="text-xl text-gray-700 mb-2">Дұрыс жауаптар саны: <span id="score" class="font-extrabold text-indigo-600">0</span> / 37</p>
            <p id="percentage" class="text-xl font-bold text-gray-700"></p>
        </div>
    </div>

    <script>
        const quizData = [
            // --- МАТЕМАТИКА (Күрделендірілген 1-28) ---
            // 1-2. Арифметикалық прогрессия
            {
                q: "1. Арифметикалық прогрессияда $a_1 = -10,5$ және $a_2 = -9$ болса, оның $a_{11}$ мүшесін табыңыз. (А деңгейі)",
                options: ["4,5", "5,5", "3,5", "6"],
                correct: "4,5"
            },
            {
                q: "2. Арифметикалық прогрессияның $S_5 = 65$ және $a_1 = 1$ болса, прогрессияның айырмасын ($d$) табыңыз. (Б деңгейі)",
                options: ["4", "5", "6", "3"],
                correct: "6"
            },
            // 3-4. Геометриялық прогрессия
            {
                q: "3. Геометриялық прогрессияның $b_2 = 6$ және $b_4 = 54$ ($q>0$) болса, $b_1$ мүшесін табыңыз. (А деңгейі)",
                options: ["2", "1", "3", "0.5"],
                correct: "2"
            },
            {
                q: "4. Шексіз кемімелі геометриялық прогрессияның қосындысын табыңыз: $12; 4; \\frac{4}{3}; \\dots$ (Б деңгейі)",
                options: ["16", "18", "24", "20"],
                correct: "18"
            },
            // 5-6. Жүйе
            {
                q: "5. Теңдеулер жүйесін шешіңіз: $\\begin{cases} 3x - 2y = 12 \\\\ 4x + y = 27 \\end{cases}$ (А деңгейі)",
                options: ["(6; 3)", "(5; 7)", "(4; 11)", "(3; -1.5)"],
                correct: "(6; 3)"
            },
            {
                q: "6. Теңдеулер жүйесін шешіңіз: $\\begin{cases} x^2 + y^2 = 25 \\\\ xy = 12 \\end{cases}$ (Б деңгейі)",
                options: ["(3;4), (4;3), (-3;-4), (-4;-3)", "(3;4), (-3;-4)", "(5;0), (0;5)", "Шешімі жоқ"],
                correct: "(3;4), (4;3), (-3;-4), (-4;-3)"
            },
            // 7-8. Теңсіздік
            {
                q: "7. Бөлшек-сызықтық теңсіздікті шешіңіз: $\\frac{2x - 6}{x + 1} \\le 0$. (А деңгейі)",
                options: ["$(-1; 3]$", "$[-1; 3]$", "$(-\\infty; -1) \\cup [3; \\infty)$", "$(-1; 3)$"],
                correct: "$(-1; 3]$"
            },
            {
                q: "8. $x^2 - 5x + 6 > 0$ теңсіздігін шешіңіз. (Б деңгейі)",
                options: ["$(-\\infty; 2) \\cup (3; \\infty)$", "$(2; 3)$", "$[2; 3]$", "$(3; \\infty)$"],
                correct: "$(-\\infty; 2) \\cup (3; \\infty)$"
            },
            // 9-10. Дәрежелік теңдеу
            {
                q: "9. $x^{\\frac{3}{2}} = 27$ теңдеуінің түбірін табыңыз. (А деңгейі)",
                options: ["9", "3", "81", "6"],
                correct: "9"
            },
            {
                q: "10. $2^{x^2 - x} = 4$ теңдеуінің түбірлерін табыңыз. (Б деңгейі)",
                options: ["-1; 2", "1; -2", "2; 3", "0; 1"],
                correct: "-1; 2"
            },
            // 11-12. Дәрежелік теңсіздік
            {
                q: "11. $(0,2)^{2x-1} > 25$ теңсіздігін шешіңіз. (А деңгейі)",
                options: ["$x < -0,5$", "$x > -0,5$", "$x < 0,5$", "$x > 1,5$"],
                correct: "$x < -0,5$"
            },
            {
                q: "12. $3^{x^2} < 3^{x+2}$ теңсіздігін шешіңіз. (Б деңгейі)",
                options: ["$(-1; 2)$", "$( -\\infty; -1) \\cup (2; \\infty)$", "$(-2; 1)$", "$(1; 2)$"],
                correct: "$(-1; 2)$"
            },
            // 13-14. Вектор
            {
                q: "13. $\\vec{a}(2; -3)$ және $\\vec{b}(-4; 1)$ векторлары берілген. $2\\vec{a} + \\vec{b}$ векторының координатасын табыңыз. (А деңгейі)",
                options: ["(0; -5)", "(0; -2)", "(-2; -2)", "(8; -7)"],
                correct: "(0; -5)"
            },
            {
                q: "14. $\\vec{a}(3; 4)$ және $\\vec{b}(m; 2)$ векторлары перпендикуляр болатындай $m$-нің мәнін табыңыз. (Б деңгейі)",
                options: ["$-8/3$", "$-3/2$", "3", "6"],
                correct: "$-8/3$"
            },
            // 15-16. График
            {
                q: "15. $y = -2x + 4$ түзуінің графигі координаталық ширектердің қайсысында жатпайды? (А деңгейі)",
                options: ["III ширекте", "I ширекте", "II ширекте", "IV ширекте"],
                correct: "III ширекте"
            },
            {
                q: "16. $y = kx + b$ түзуі $A(1; 3)$ және $B(-1; -7)$ нүктелері арқылы өтеді. $k$ мен $b$-ны табыңыз. (Б деңгейі)",
                options: ["$k=5, b=-2$", "$k=2, b=1$", "$k=4, b=-1$", "$k=3, b=0$"],
                correct: "$k=5, b=-2$"
            },
            // 17-18. Дискриминант
            {
                q: "17. $5x^2 - 8x + 3 = 0$ теңдеуінің түбірлерін дискриминант арқылы табыңыз. (А деңгейі)",
                options: ["$1; 0,6$", "$-1; -0,6$", "$2; 3$", "$1; 3$"],
                correct: "$1; 0,6$"
            },
            {
                q: "18. $px^2 - 2x + p = 0$ теңдеуінің түбірлері болмау үшін $p$-ның мәні қандай болу керек? (Б деңгейі)",
                options: ["$|p| > 1$", "$|p| < 1$", "$p = 1$", "$p > 0$"],
                correct: "$|p| > 1$"
            },
            // 19. Геометрия (Анықтама - ЖАҢАРТЫЛДЫ: Косинус)
            {
                q: "19. Тікбұрышты үшбұрышта бұрышқа іргелес жатқан катеттің гипотенузаға қатынасы не деп аталады?",
                options: ["Косинус", "Тангенс", "Синус", "Котангенс"],
                correct: "Косинус"
            },
            // 20-21. Қысқаша көбейту (21 ЖАҢАРТЫЛДЫ: Ықшамдау)
            {
                q: "20. Өрнекті ықшамдаңыз: $(x^2 - 2)(x^2 + 2) - (x^2 - 1)^2$. (А деңгейі)",
                options: ["$2x^2 - 5$", "$2x^2 - 3$", "$x^4 - 5$", "$-5$"],
                correct: "$2x^2 - 5$"
            },
            {
                q: "21. Өрнекті ықшамдаңыз: $(x+3)^2 - x(x+6)$. (Б деңгейі)",
                options: ["9", "$6x+9$", "$2x^2+6x+9$", "0"],
                correct: "9"
            },
            // 22. Формула (ЖАҢАРТЫЛДЫ: Кубтардың қосындысы емес, қосындының кубы)
            {
                q: "22. Қысқаша көбейту формуласы: $(a+b)^3$ өрнегінің жіктелуін көрсетіңіз.",
                options: ["$a^3 + 3a^2b + 3ab^2 + b^3$", "$a^3 - 3a^2b + 3ab^2 - b^3$", "$a^3 + b^3$", "$(a+b)(a^2-ab+b^2)$"],
                correct: "$a^3 + 3a^2b + 3ab^2 + b^3$"
            },
            // 23-24. Үшбұрыш ауданы
            {
                q: "23. Тікбұрышты үшбұрыштың катеттері 9 см және 40 см. Ауданын табыңыз. (А деңгейі)",
                options: ["180 см$^2$", "360 см$^2$", "160 см$^2$", "90 см$^2$"],
                correct: "180 см$^2$"
            },
            {
                q: "24. Тікбұрышты үшбұрыштың гипотенузасы 13 см, бір катеті 5 см. Ауданын табыңыз. (Б деңгейі)",
                options: ["30 см$^2$", "60 см$^2$", "65 см$^2$", "32.5 см$^2$"],
                correct: "30 см$^2$"
            },
            // 25-26. Радиан (Ширексіз)
            {
                q: "25. $270^\circ$ бұрышы радианмен жазылуы қандай?",
                options: ["$3\\pi/2$", "$\\pi$", "$5\\pi/4$", "$4\\pi/3$"],
                correct: "$3\\pi/2$"
            },
            {
                q: "26. $-150^\circ$ бұрышы радианмен жазылуы қандай?",
                options: ["$-5\\pi/6$", "$-2\\pi/3$", "$-3\\pi/4$", "$-7\\pi/6$"],
                correct: "$-5\\pi/6$"
            },
            // 27-28. Тригонометриялық мәндер (Қиындатылған)
            {
                q: "27. $2\\cos 60^\circ - \\tan 45^\circ$ мәнін есептеңіз.",
                options: ["0", "1", "2", "-1"],
                correct: "0"
            },
            {
                q: "28. $\\sin^2 30^\circ + \\cos^2 30^\circ$ өрнегінің мәні нешеге тең?",
                options: ["1", "0.5", "0", "2"],
                correct: "1"
            },
            
            // --- ЖАҢА ТАПСЫРМАЛАР (29-37) ---
            
            // Тригонометрия (Градустан мәнге)
            {
                q: "29. $\\cos 60^\circ$ мәні нешеге тең?",
                options: ["$1/2$", "$\\sqrt{3}/2$", "$\\sqrt{2}/2$", "1"],
                correct: "$1/2$"
            },
            {
                q: "30. $\\tan 330^\circ$ мәні нешеге тең? (Келтіру формуласын қолданыңыз)",
                options: ["$-\\frac{\\sqrt{3}}{3}$", "$\\frac{\\sqrt{3}}{3}$", "$-\\sqrt{3}$", "$\\sqrt{3}$"],
                correct: "$-\\frac{\\sqrt{3}}{3}$"
            },
            
            // Тригонометрия (Градустан Пи-ге)
            {
                q: "31. $315^\circ$ бұрышын радиандық өлшеммен ($\pi$ арқылы) жазыңыз.",
                options: ["$\\frac{7\\pi}{4}$", "$\\frac{5\\pi}{4}$", "$\\frac{3\\pi}{2}$", "$\\frac{11\\pi}{6}$"],
                correct: "$\\frac{7\\pi}{4}$"
            },
            {
                q: "32. $180^\circ$ бұрышын радиандық өлшеммен ($\pi$ арқылы) жазыңыз.",
                options: ["$\\pi$", "$2\\pi$", "$\\frac{\\pi}{2}$", "$\\frac{3\\pi}{2}$"],
                correct: "$\\pi$"
            },
            
            // Қиын сұрақ
            {
                q: "33. $\\cot 540^\circ$ мәні нешеге тең?",
                options: ["Анықталмаған", "0", "1", "-1"],
                correct: "Анықталмаған"
            },
            
            // Физика (Кинематика)
            {
                q: "34. (Физика А) Автокөлік 2 м/с$^2$ үдеумен қозғалып, 4 секундта жылдамдығын қаншаға өзгертеді?",
                options: ["8 м/с", "6 м/с", "4 м/с", "16 м/с"],
                correct: "8 м/с"
            },
            {
                q: "35. (Физика Б) Дене $h=80$ метр биіктіктен еркін құлайды ($g=10$ м/с$^2$). Дене жерге қанша уақытта түседі?",
                options: ["4 с", "8 с", "2 с", "5 с"],
                correct: "4 с"
            },
            
            // Физика (Динамика - Ньютон заңдары)
            {
                q: "36. (Ньютонның 2-ші заңы) Массасы 5 кг денеге 20 Н күш әсер етсе, дене қандай үдеу алады?",
                options: ["4 м/с$^2$", "100 м/с$^2$", "0.25 м/с$^2$", "25 м/с$^2$"],
                correct: "4 м/с$^2$"
            },
            {
                q: "37. (Ньютонның 3-ші заңы) Жүк көлігі мен жеңіл көлік соқтығысқанда, қайсысына әсер ететін күш модулі бойынша үлкен?",
                options: ["Күштері тең", "Жүк көлігіне әсер ететін күш үлкен", "Жеңіл көлікке әсер ететін күш үлкен", "Массаға байланысты"],
                correct: "Күштері тең"
            }
        ];

        // --- Logic (Unchanged but ensuring MathJax works) ---
        const questionsList = document.getElementById('questions-list');
        const scoreSpan = document.getElementById('score');
        const percentageP = document.getElementById('percentage');
        const resultsTitle = document.getElementById('results-title');
        const timeSetupDiv = document.getElementById('time-setup');
        const timeInput = document.getElementById('time-input');
        const timerContainer = document.getElementById('timer-container');
        const timerDisplay = document.getElementById('time-left');
        const submitButton = document.getElementById('submit-button');
        const restartButton = document.getElementById('restart-button');
        const resultsDiv = document.getElementById('results');

        let TIME_LIMIT_SECONDS = 1800; 
        let timeLeft = TIME_LIMIT_SECONDS;
        let timerInterval = null;

        function formatTime(s) {
            const m = Math.floor(s / 60);
            const sec = s % 60;
            return `${String(m).padStart(2,'0')}:${String(sec).padStart(2,'0')}`;
        }

        function updateTimerDisplay() {
            timerDisplay.textContent = formatTime(timeLeft);
            if (timeLeft <= 60) {
                timerContainer.classList.remove('bg-red-100', 'border-red-400');
                timerContainer.classList.add('bg-red-500', 'text-white', 'animate-pulse-custom');
                timerContainer.querySelector('p').classList.remove('text-red-700');
                timerContainer.querySelector('p').classList.add('text-white');
            } else {
                timerContainer.classList.remove('bg-red-500', 'text-white', 'animate-pulse-custom');
                timerContainer.classList.add('bg-red-100', 'border-red-400');
                timerContainer.querySelector('p').classList.add('text-red-700');
                timerContainer.querySelector('p').classList.remove('text-white');
            }
        }

        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            timeLeft = TIME_LIMIT_SECONDS;
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitQuiz(true);
                }
            }, 1000);
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function renderQuizStructure() {
            questionsList.innerHTML = '';
            quizData.forEach((data, index) => {
                const qNum = index + 1;
                const div = document.createElement('div');
                div.className = 'question-card bg-white p-6 mb-8 border border-gray-200 rounded-xl shadow-lg';
                div.id = `q-${qNum}`;
                div.innerHTML = `<p class="text-lg font-semibold mb-4 text-gray-800">${data.q}</p><div class="options-container space-y-3" id="options-${qNum}"></div>`;
                
                const container = div.querySelector(`#options-${qNum}`);
                const labels = ['А', 'Б', 'В', 'Г'];
                const shuffled = shuffle([...data.options]);

                shuffled.forEach((txt, i) => {
                    const id = `q${qNum}-opt${i}`;
                    const isCorrect = txt === data.correct;
                    const lbl = document.createElement('label');
                    lbl.htmlFor = id;
                    lbl.className = 'flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-indigo-50 transition duration-150';
                    lbl.innerHTML = `
                        <input type="radio" id="${id}" name="q${qNum}" value="${txt}" class="hidden" data-correct="${isCorrect}">
                        <span class="option-label bg-gray-200 text-gray-600">${labels[i]}</span>
                        <span class="text-base text-gray-700 ml-2">${txt}</span>
                    `;
                    lbl.addEventListener('click', () => {
                        container.querySelectorAll('label').forEach(l => {
                            l.classList.remove('bg-indigo-200', 'border-indigo-500');
                            l.classList.add('border-gray-300');
                        });
                        lbl.classList.remove('border-gray-300');
                        lbl.classList.add('bg-indigo-200', 'border-indigo-500');
                    });
                    container.appendChild(lbl);
                });
                questionsList.appendChild(div);
            });
            if (window.MathJax) MathJax.typesetPromise();
        }

        function startQuiz() {
            const m = parseInt(timeInput.value, 10);
            if (isNaN(m) || m < 5 || m > 180) {
                timeInput.classList.add('border-red-500', 'ring-2', 'ring-red-200');
                setTimeout(() => timeInput.classList.remove('border-red-500', 'ring-2', 'ring-red-200'), 2000);
                return;
            }
            TIME_LIMIT_SECONDS = m * 60;
            timeSetupDiv.classList.add('hidden');
            timerContainer.classList.remove('hidden');
            questionsList.classList.remove('hidden');
            submitButton.classList.remove('hidden');
            renderQuizStructure(); // Render on start to ensure clean state
            startTimer();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function submitQuiz(isTimeout = false) {
            if (timerInterval) clearInterval(timerInterval);
            resultsTitle.textContent = isTimeout ? 'НӘТИЖЕ (Уақыт Аяқталды):' : 'Нәтижелер:';
            
            let score = 0;
            quizData.forEach((data, i) => {
                const qNum = i + 1;
                const card = document.getElementById(`q-${qNum}`);
                const container = document.getElementById(`options-${qNum}`);
                const selected = document.querySelector(`input[name="q${qNum}"]:checked`);
                
                document.querySelectorAll(`input[name="q${qNum}"]`).forEach(inp => inp.disabled = true);
                
                let isCorrect = false;
                if (selected) {
                    const val = selected.value.trim().replace(/[\$\\]/g, '');
                    const cor = data.correct.trim().replace(/[\$\\]/g, '');
                    if (val === cor) { score++; isCorrect = true; }
                }

                container.querySelectorAll('label').forEach(lbl => {
                    const inp = lbl.querySelector('input');
                    lbl.classList.remove('bg-indigo-200', 'border-indigo-500', 'hover:bg-indigo-50');
                    const val = inp.value.trim().replace(/[\$\\]/g, '');
                    const cor = data.correct.trim().replace(/[\$\\]/g, '');
                    const badge = lbl.querySelector('.option-label');
                    badge.classList.remove('bg-gray-200', 'text-gray-600');

                    if (val === cor) {
                        lbl.classList.add('bg-green-100', 'border-green-600', 'font-bold');
                        badge.classList.add('bg-green-600', 'text-white');
                    } else if (inp === selected && !isCorrect) {
                        lbl.classList.add('bg-red-100', 'border-red-600', 'font-bold');
                        badge.classList.add('bg-red-600', 'text-white');
                    } else {
                        lbl.classList.add('bg-gray-50', 'border-gray-200');
                        badge.classList.add('bg-gray-300', 'text-gray-700');
                    }
                });
                card.classList.remove('border-gray-200');
                card.classList.add(isCorrect ? 'border-green-500' : 'border-red-500', 'shadow-xl');
            });

            const pct = ((score / quizData.length) * 100).toFixed(1);
            scoreSpan.textContent = score;
            percentageP.textContent = `Пайыздық көрсеткіш: ${pct}%`;
            percentageP.className = `text-xl font-bold ${pct >= 80 ? 'text-green-600' : pct >= 50 ? 'text-yellow-600' : 'text-red-600'}`;
            
            resultsDiv.classList.remove('hidden');
            submitButton.classList.add('hidden');
            restartButton.classList.remove('hidden');
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function restartQuiz() {
            timeSetupDiv.classList.remove('hidden');
            timerContainer.classList.add('hidden');
            questionsList.classList.add('hidden');
            submitButton.classList.add('hidden');
            restartButton.classList.add('hidden');
            resultsDiv.classList.add('hidden');
            timeInput.value = '30';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
