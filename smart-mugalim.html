<!doctype html>
<html lang="kk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Smart Mugalim ‚Äî –¢“Ø–≥–µ–Ω–¥–µ—É</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body{margin:0;font-family:Arial,Helvetica,sans-serif;display:flex;height:100vh}
    .sidebar{width:240px;background:#111827;color:#fff;padding:18px;display:flex;flex-direction:column}
    .sidebar h2{margin:0 0 18px 0}
    .nav-btn{background:none;border:none;color:#fff;padding:10px;text-align:left;cursor:pointer;border-radius:6px;margin-bottom:6px}
    .nav-btn:hover{background:#374151}
    .content{flex:1;padding:18px;display:flex;flex-direction:column;background:#f3f4f6;overflow:auto}
    .topbar{display:flex;gap:8px;margin-bottom:12px}
    .topbar button{padding:8px 12px;border-radius:6px;border:none;cursor:pointer;background:#2563eb;color:white}
    .topbar button.ghost{background:#e5e7eb;color:#111}
    .work{display:flex;gap:16px}
    .left-work{width:280px;background:#fff;padding:12px;border-radius:8px;box-shadow:0 1px 3px rgba(0,0,0,0.06)}
    .right-work{flex:1;background:#fff;padding:12px;border-radius:8px;box-shadow:0 1px 3px rgba(0,0,0,0.06)}
    .student-item{display:flex;justify-content:space-between;align-items:center;padding:6px 8px;border-radius:6px;border:1px solid #eef2f7;margin-bottom:6px;background:#fbfdff}
    .student-item .del{background:#ef4444;border:none;color:white;padding:6px 8px;border-radius:6px;cursor:pointer}
    .saved-list-item{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:6px;border:1px solid #e6eef8;margin-bottom:6px;background:#fff}
    .small{font-size:13px;color:#374151}
    input[type="text"]{padding:8px;border:1px solid #d1d5db;border-radius:6px;width:100%}
    .muted{color:#6b7280;font-size:13px}
    .grid-4{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
    .grid-4 div{padding:6px 8px;border:1px solid #ddd;border-radius:6px;background:#f9fafb}
  </style>
</head>
<body>
  <!-- –°–æ–ª –∂–∞“õ –ø–∞–Ω–µ–ª—å -->
  <div class="sidebar">
    <h2>Groowin</h2>
    <button class="nav-btn" onclick="location.href='index.html'">üè† –ë–∞—Å—Ç—ã –±–µ—Ç</button>
    <button class="nav-btn" onclick="location.href='smart-mugalim.html'">üë®üèª‚Äçüéì Smart Mugalim</button>
    <hr style="border:none;border-top:1px solid #26303a;margin:12px 0">
    <div class="small muted">–ù–∞–≤–∏–≥–∞—Ü–∏—è</div>
    <button class="nav-btn" onclick="showSection('tugen')">‚úÖ –¢“Ø–≥–µ–Ω–¥–µ—É</button>
  </div>

  <!-- –ñ“±–º—ã—Å –∞–π–º–∞“ì—ã -->
  <div class="content">
    <div class="topbar">
      <button id="topListBtn">–¢—ñ–∑—ñ–º</button>
      <button id="topQRBtn" class="ghost">QR</button>
      <button id="topGeoBtn" class="ghost">–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è</button>
    </div>

    <div class="work">
      <!-- –°–æ–ª –∂–∞“õ -->
      <div class="left-work">
        <h4 style="margin-top:0">–°—ã–Ω—ã–ø</h4>
        <label class="small">–°—ã–Ω—ã–ø –∞—Ç–∞—É—ã</label>
        <input id="className" type="text" placeholder="–ú—ã—Å: 8A" style="margin-bottom:8px"/>

        <label class="small">–û“õ—É—à—ã “õ–æ—Å—É (Enter –±–∞—Å—ã“£—ã–∑)</label>
        <input id="nameInput" type="text" placeholder="–ê—Ç—ã-–∂”©–Ω—ñ" />

        <div style="margin-top:8px;display:flex;gap:8px">
          <button id="addNameBtn" style="padding:8px 10px;background:#10b981;color:white;border-radius:6px">“ö–æ—Å—É</button>
          <button id="saveClassBtn" style="padding:8px 10px;border-radius:6px;background:#2563eb;color:white;border:none">–°–∞“õ—Ç–∞—É</button>
        </div>

        <hr style="margin:12px 0;border:none;border-top:1px solid #eef2f7"/>

        <h4 style="margin:0 0 8px 0">–¢—ñ–∑—ñ–º–¥–µ—Ä</h4>
        <div id="savedLists" style="max-height:340px;overflow:auto"></div>
      </div>

      <!-- –û“£ –∂–∞“õ -->
      <div class="right-work">
        <!-- –¢—ñ–∑—ñ–º -->
        <div id="listSection" class="section">
          <h4 style="margin-top:0">–ê“ì—ã–º–¥–∞“ì—ã —Ç—ñ–∑—ñ–º</h4>
          <div id="currentClassName" class="muted">–°—ã–Ω—ã–ø: ‚Äî</div>
          <div id="currentNames" style="margin-top:10px"></div>
        </div>

        <!-- QR -->
        <div id="qrSection" class="section" style="display:none">
          <h4>QR ‚Äî —Ç–∞“£–¥–∞–ª“ì–∞–Ω —Å—ã–Ω—ã–ø</h4>
          <div id="qrNames" class="grid-4"></div>
        </div>

        <!-- –ì–µ–æ -->
        <div id="geoSection" class="section" style="display:none">
          <h4>–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è</h4>
          <p class="muted">–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –∫–µ–π—ñ–Ω “õ–æ—Å—ã–ª–∞–¥—ã.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDP2SHjJQYzu_lhWUbk1NBN6H65mR5YI_s",
      authDomain: "groowin-attendance.firebaseapp.com",
      projectId: "groowin-attendance",
      storageBucket: "groowin-attendance.appspot.com",
      messagingSenderId: "737566994771",
      appId: "1:737566994771:web:982cf9e32e968229f2b1a6"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let currentNames = [];
    let currentClass = "";

    const nameInput = () => document.getElementById('nameInput');
    const classNameInput = () => document.getElementById('className');
    const currentNamesDiv = () => document.getElementById('currentNames');
    const currentClassNameEl = () => document.getElementById('currentClassName');
    const savedListsDiv = () => document.getElementById('savedLists');

    window.onload = () => {
      document.getElementById('topListBtn').onclick = () => showOnly('list');
      document.getElementById('topQRBtn').onclick = () => showOnly('qr');
      document.getElementById('topGeoBtn').onclick = () => showOnly('geo');

      document.getElementById('addNameBtn').onclick = addNameFromInput;
      document.getElementById('saveClassBtn').onclick = saveClass;

      document.getElementById('nameInput').addEventListener('keydown', e=>{
        if(e.key==='Enter'){ e.preventDefault(); addNameFromInput(); }
      });

      loadSavedLists();
    };

    function showOnly(tab){
      document.getElementById('listSection').style.display = (tab==='list') ? 'block':'none';
      document.getElementById('qrSection').style.display = (tab==='qr') ? 'block':'none';
      document.getElementById('geoSection').style.display = (tab==='geo') ? 'block':'none';

      if(tab==='qr' && currentClass){
        renderQR();
      }
    }

    function addNameFromInput(){
      const v = nameInput().value.trim();
      if(!v) return;
      currentNames.push(v);
      nameInput().value='';
      renderCurrentNames();
    }

    function renderCurrentNames(){
      const cont = currentNamesDiv();
      cont.innerHTML='';
      currentNames.forEach((nm,i)=>{
        const el=document.createElement('div');
        el.className='student-item';
        el.innerHTML=`<div>${nm}</div>`;
        const del=document.createElement('button');
        del.className='del'; del.textContent='”®—à—ñ—Ä—É';
        del.onclick=()=>{ currentNames.splice(i,1); renderCurrentNames(); };
        el.appendChild(del);
        cont.appendChild(el);
      });
      currentClassNameEl().textContent=currentClass ? '–°—ã–Ω—ã–ø: '+currentClass : '–°—ã–Ω—ã–ø: ‚Äî';
    }

    function saveClass(){
      const cls=classNameInput().value.trim();
      if(!cls) return alert('–°—ã–Ω—ã–ø –∞—Ç–∞—É—ã–Ω –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑');
      if(currentNames.length===0) return alert('–û“õ—É—à—ã–ª–∞—Ä –∂–æ“õ');
      db.ref('lists/'+cls).set({names:currentNames,created:Date.now()}).then(()=>{
        currentClass=cls;
        loadSavedLists();
        renderCurrentNames();
      });
    }

    function loadSavedLists(){
      savedListsDiv().innerHTML='';
      db.ref('lists').once('value').then(snap=>{
        const val=snap.val()||{};
        Object.keys(val).forEach(k=>{
          const node=val[k];
          const div=document.createElement('div');
          div.className='saved-list-item';
          div.innerHTML=`<strong>${k}</strong> <span class="small">(${(node.names||[]).length} –æ“õ—É—à—ã)</span>`;
          div.onclick=()=>{ currentNames=node.names; currentClass=k; renderCurrentNames(); };
          savedListsDiv().appendChild(div);
        });
      });
    }

    function renderQR(){
      const cont=document.getElementById('qrNames');
      cont.innerHTML='';
      currentNames.forEach(nm=>{
        const d=document.createElement('div');
        d.textContent=nm;
        cont.appendChild(d);
      });
    }
  </script>
</body>
</html>
