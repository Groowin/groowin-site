<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Математика және Физика: Кешенді Тест</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- MathJax CDN for rendering LaTeX math formulas -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f7fafc; }
        .question-card { transition: all 0.3s ease; }
        .option-label {
            width: 1.5rem; height: 1.5rem; display: flex;
            align-items: center; justify-content: center;
            border-radius: 50%; background-color: #e5e7eb;
            color: #4b5563; font-weight: 600; margin-right: 0.75rem;
            flex-shrink: 0;
        }
        @keyframes pulse-red {
            0%, 100% { background-color: #ef4444; }
            50% { background-color: #fca5a5; }
        }
        .animate-pulse-custom { animation: pulse-red 1s infinite; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 sm:p-8">

    <div id="quiz-container" class="w-full max-w-4xl bg-white shadow-2xl rounded-xl p-6 sm:p-10">
        
        <h1 class="text-3xl sm:text-4xl font-extrabold text-center text-indigo-700 mb-2">
            Математика және Физика
        </h1>
        <p class="text-center text-gray-500 mb-8 sm:mb-6">
            Барлығы 40 сұрақ. (Математика + Физика)
        </p>

        <!-- Time Setup Section -->
        <div id="time-setup" class="mb-8 p-6 bg-indigo-50 border border-indigo-200 rounded-xl shadow-md text-center">
            <h2 class="text-xl font-bold text-indigo-700 mb-4">Тест уақытын белгілеңіз (минутпен)</h2>
            <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                <input type="number" id="time-input" value="40" min="5" max="180" class="w-full sm:w-40 p-3 border-2 border-indigo-300 rounded-lg text-2xl text-center font-semibold focus:outline-none focus:border-indigo-500">
                <button onclick="startQuiz()" class="w-full sm:w-auto whitespace-nowrap bg-green-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-700 transition duration-300 shadow-md">
                    Тестті Бастау
                </button>
            </div>
            <p class="text-sm text-gray-500 mt-2">Ұсынылатын уақыт: 30-45 минут.</p>
        </div>

        <!-- Timer Display -->
        <div id="timer-container" class="mb-6 p-3 bg-red-100 border border-red-400 rounded-lg shadow-md text-center hidden">
            <p class="text-lg font-bold text-red-700">
                Қалған уақыт: <span id="time-left" class="text-2xl font-extrabold ml-2">00:00</span>
            </p>
        </div>

        <div id="questions-list" class="hidden"></div>

        <div class="mt-10 flex flex-col sm:flex-row gap-4">
            <button id="submit-button" onclick="submitQuiz()" class="w-full sm:w-1/2 bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 transition duration-300 shadow-md hidden">
                Жауаптарды Тексеру
            </button>
            <button id="restart-button" onclick="restartQuiz()" class="w-full sm:w-1/2 bg-gray-300 text-gray-800 font-bold py-3 px-6 rounded-lg hover:bg-gray-400 transition duration-300 shadow-md hidden">
                Тестті Қайта Бастау
            </button>
        </div>

        <div id="results" class="mt-10 p-6 bg-gray-100 border-l-4 border-indigo-500 rounded-lg shadow-inner hidden">
            <h2 id="results-title" class="text-2xl font-bold text-gray-800 mb-4">Нәтижелер:</h2>
            <p class="text-xl text-gray-700 mb-2">Дұрыс жауаптар саны: <span id="score" class="font-extrabold text-indigo-600">0</span> / 40</p>
            <p id="percentage" class="text-xl font-bold text-gray-700"></p>
        </div>
    </div>

    <script>
        const quizData = [
            // --- МАТЕМАТИКА (АЛГЕБРА) ---
            // 1-2. Арифметикалық прогрессия (ЖАҢА)
            {
                q: "1. Арифметикалық прогрессияда $a_1 = 12$ және $d = -3$ болса, $a_5$ мүшесін табыңыз.",
                options: ["0", "3", "-3", "6"],
                correct: "0"
            },
            {
                q: "2. Арифметикалық прогрессияның $4$-ші мүшесі 10, ал $6$-шы мүшесі 18. Айырмасын ($d$) табыңыз.",
                options: ["4", "2", "8", "6"],
                correct: "4"
            },
            // 3-4. Геометриялық прогрессия (ЖАҢА)
            {
                q: "3. Геометриялық прогрессияда $b_1 = 3$ және $q = 2$. Алғашқы 4 мүшесінің қосындысын табыңыз.",
                options: ["45", "15", "30", "60"],
                correct: "45"
            },
            {
                q: "4. Геометриялық прогрессияның $b_3 = 12$ және $b_4 = 24$. Прогрессияның еселігін ($q$) табыңыз.",
                options: ["2", "3", "0.5", "4"],
                correct: "2"
            },
            // 5-6. Жүйе (ЖАҢА)
            {
                q: "5. Теңдеулер жүйесін шешіңіз: $\\begin{cases} x + 2y = 8 \\\\ x - y = 2 \\end{cases}$",
                options: ["(4; 2)", "(2; 4)", "(6; 1)", "(4; -2)"],
                correct: "(4; 2)"
            },
            {
                q: "6. Теңдеулер жүйесін шешіңіз: $\\begin{cases} 3x + y = 10 \\\\ x^2 - y = 8 \\end{cases}$",
                options: ["(3; 1) және (-6; 28)", "(3; 1)", "(2; 4)", "(1; 7)"],
                correct: "(3; 1) және (-6; 28)"
            },
            // 7-8. Теңсіздік (ЖАҢА)
            {
                q: "7. $2(x - 3) > 4$ теңсіздігін шешіңіз.",
                options: ["$x > 5$", "$x > 1$", "$x < 5$", "$x > 7$"],
                correct: "$x > 5$"
            },
            {
                q: "8. $x^2 - 16 \\le 0$ теңсіздігін шешіңіз.",
                options: ["$[-4; 4]$", "$(-\\infty; 4]$", "$[0; 4]$", "$(-\\infty; -4] \\cup [4; \\infty)$"],
                correct: "$[-4; 4]$"
            },
            // 9-10. Дәрежелік теңдеу (ЖАҢА)
            {
                q: "9. $5^{x+2} = 125$ теңдеуін шешіңіз.",
                options: ["1", "3", "2", "0"],
                correct: "1"
            },
            {
                q: "10. $x^3 + 1 = 9$ теңдеуін шешіңіз.",
                options: ["2", "$\\sqrt[3]{8}$", "3", "4"],
                correct: "2"
            },
            // 11-12. Дәрежелік теңсіздік (ЖАҢА)
            {
                q: "11. $3^x > 27$ теңсіздігін шешіңіз.",
                options: ["$x > 3$", "$x < 3$", "$x \\ge 3$", "$x > 9$"],
                correct: "$x > 3$"
            },
            {
                q: "12. $(0.5)^x < 0.25$ теңсіздігін шешіңіз (негізі 1-ден кіші екенін ескеріңіз).",
                options: ["$x > 2$", "$x < 2$", "$x > 4$", "$x < 0.5$"],
                correct: "$x > 2$"
            },
            // 13-14. Вектор (ЖАҢА)
            {
                q: "13. $\\vec{a}(1; 4)$ және $\\vec{b}(-3; 2)$ векторларының скаляр көбейтіндісін табыңыз.",
                options: ["5", "11", "-5", "6"],
                correct: "5"
            },
            {
                q: "14. $\\vec{c}(6; 8)$ векторының ұзындығын (модулін) табыңыз.",
                options: ["10", "14", "100", "48"],
                correct: "10"
            },
            // 15-16. График (ЖАҢА)
            {
                q: "15. $y = 3x - 6$ түзуінің $x$-өсімен қиылысу нүктесін табыңыз.",
                options: ["(2; 0)", "(0; -6)", "(-2; 0)", "(3; 0)"],
                correct: "(2; 0)"
            },
            {
                q: "16. $y = -x + 5$ функциясының графигі қай ширектер арқылы өтеді?",
                options: ["I, II, IV", "I, II, III", "II, III, IV", "I, III, IV"],
                correct: "I, II, IV"
            },
            // 17-18. Дискриминант (ЖАҢА)
            {
                q: "17. $x^2 - 4x + 3 = 0$ теңдеуінің дискриминантын табыңыз.",
                options: ["4", "16", "12", "-4"],
                correct: "4"
            },
            {
                q: "18. $x^2 + 6x + 9 = 0$ теңдеуінің неше түбірі бар?",
                options: ["Бір (сәйкес) түбірі бар", "Екі түбірі бар", "Түбірі жоқ", "Үш түбірі бар"],
                correct: "Бір (сәйкес) түбірі бар"
            },
            // 19. Анықтама (ЖАҢА: Синус)
            {
                q: "19. Тікбұрышты үшбұрышта бұрышқа қарама-қарсы жатқан катеттің гипотенузаға қатынасы қалай аталады?",
                options: ["Синус", "Косинус", "Тангенс", "Котангенс"],
                correct: "Синус"
            },
            // 20-21. Қысқаша көбейту (ЖАҢА)
            {
                q: "20. Көбейткіштерге жіктеңіз: $a^2 - 49$.",
                options: ["$(a-7)(a+7)$", "$(a-7)^2$", "$(a+7)^2$", "$a(a-49)$"],
                correct: "$(a-7)(a+7)$"
            },
            {
                q: "21. Өрнекті ашып жазыңыз: $(x+5)^2$.",
                options: ["$x^2 + 10x + 25$", "$x^2 + 25$", "$x^2 + 5x + 25$", "$x^2 - 10x + 25$"],
                correct: "$x^2 + 10x + 25$"
            },
            // 22. Формула (ЖАҢА: Пифагор)
            {
                q: "22. Тікбұрышты үшбұрыш үшін Пифагор теоремасының дұрыс жазылуын көрсетіңіз ($c$ - гипотенуза).",
                options: ["$c^2 = a^2 + b^2$", "$c^2 = a^2 - b^2$", "$c = a + b$", "$a^2 = c^2 + b^2$"],
                correct: "$c^2 = a^2 + b^2$"
            },
            
            // --- ГЕОМЕТРИЯ (ЖАҢА ТАПСЫРМАЛАР) ---
            
            // Герон формуласы (2 есеп)
            {
                q: "23. Қабырғалары 13, 14, 15 болатын үшбұрыштың ауданын Герон формуласы арқылы табыңыз.",
                options: ["84", "80", "42", "96"],
                correct: "84"
            },
            {
                q: "24. Қабырғалары 3, 4, 5 болатын үшбұрыштың ауданын табыңыз.",
                options: ["6", "12", "10", "7.5"],
                correct: "6"
            },
            
            // Пифагор (Гипотенузаны табу - 2 есеп)
            {
                q: "25. Тікбұрышты үшбұрыштың катеттері 6 және 8 болса, гипотенузасын табыңыз.",
                options: ["10", "14", "100", "12"],
                correct: "10"
            },
            {
                q: "26. Тікбұрышты үшбұрыштың катеттері 5 және 12 болса, гипотенузасын табыңыз.",
                options: ["13", "17", "11", "15"],
                correct: "13"
            },
            
            // --- ТРИГОНОМЕТРИЯ (ЖАҢА ТАПСЫРМАЛАР) ---
            
            // Тригонометриялық теңдеулер
            {
                q: "27. Теңдеуді шешіңіз: $2\\sin x = 1$ ($0^\\circ < x < 90^\\circ$).",
                options: ["$30^\\circ$", "$45^\\circ$", "$60^\\circ$", "$90^\\circ$"],
                correct: "$30^\\circ$"
            },
            {
                q: "28. Теңдеуді шешіңіз: $\\tan(2x) = \\sqrt{3}$ ($0^\\circ < x < 90^\\circ$).",
                options: ["$30^\\circ$", "$60^\\circ$", "$15^\\circ$", "$45^\\circ$"],
                correct: "$30^\\circ$"
            },
            
            // Градустан мәнге (Келтіру)
            {
                q: "29. $\\cos 60^\\circ$ мәні нешеге тең?",
                options: ["$0.5$", "$\\frac{\\sqrt{3}}{2}$", "$\\frac{\\sqrt{2}}{2}$", "1"],
                correct: "$0.5$"
            },
            {
                q: "30. $\\tan 330^\\circ$ мәнін табыңыз (IV ширек).",
                options: ["$-\\frac{\\sqrt{3}}{3}$", "$\\sqrt{3}$", "$-1$", "$\\frac{\\sqrt{3}}{3}$"],
                correct: "$-\\frac{\\sqrt{3}}{3}$"
            },
            
            // Градустан Пи-ге
            {
                q: "31. $315^\\circ$ бұрышын радиан түрінде жазыңыз.",
                options: ["$\\frac{7\\pi}{4}$", "$\\frac{5\\pi}{4}$", "$\\frac{3\\pi}{2}$", "$\\frac{11\\pi}{6}$"],
                correct: "$\\frac{7\\pi}{4}$"
            },
            {
                q: "32. $180^\\circ$ бұрышын радиан түрінде жазыңыз.",
                options: ["$\\pi$", "$2\\pi$", "$\\frac{\\pi}{2}$", "$\\frac{3\\pi}{2}$"],
                correct: "$\\pi$"
            },
            
            // Қиын сұрақ
            {
                q: "33. $\\cot 540^\\circ$ мәні нешеге тең?",
                options: ["Анықталмаған", "0", "1", "-1"],
                correct: "Анықталмаған"
            },
            
            // --- ФИЗИКА (ЖАҢА ТАПСЫРМАЛАР) ---
            
            // Кинематика
            {
                q: "34. Жүрілген жол $S=100$ м, уақыт $t=5$ с болса, орташа жылдамдықты табыңыз.",
                options: ["20 м/с", "50 м/с", "10 м/с", "25 м/с"],
                correct: "20 м/с"
            },
            {
                q: "35. Еркін түсу кезінде дене 3 секундта қандай қашықтықты жүріп өтеді? ($g=10$ м/с$^2$, $h=\\frac{gt^2}{2}$)",
                options: ["45 м", "30 м", "90 м", "15 м"],
                correct: "45 м"
            },
            
            // Ньютон заңдары
            {
                q: "36. Массасы 2 кг денеге 10 Н күш әсер етсе, оның үдеуі қандай болады?",
                options: ["5 м/с$^2$", "20 м/с$^2$", "0.2 м/с$^2$", "12 м/с$^2$"],
                correct: "5 м/с$^2$"
            },
            {
                q: "37. Ньютонның 3-ші заңы бойынша, әсер етуші күш пен қарсы әсер етуші күш туралы не айтуға болады?",
                options: ["Модульдері тең, бағыттары қарама-қарсы", "Модульдері әртүрлі", "Бағыттары бірдей", "Тек тыныштықта ғана тең"],
                correct: "Модульдері тең, бағыттары қарама-қарсы"
            },
            {
                q: "38. Архимед күшінің формуласы қандай? ($V$ - батырылған бөлік көлемі)",
                options: ["$F = \\rho g V$", "$F = mg$", "$F = kx$", "$F = \\mu N$"],
                correct: "$F = \\rho g V$"
            },
            {
                q: "39. Ом заңы бойынша ток күші ($I$) кернеу ($U$) мен кедергіге ($R$) қалай тәуелді?",
                options: ["$I = U/R$", "$I = U \\cdot R$", "$I = R/U$", "$I = U + R$"],
                correct: "$I = U/R$"
            },
            {
                q: "40. Кинетикалық энергияның формуласы қандай?",
                options: ["$E = \\frac{mv^2}{2}$", "$E = mgh$", "$E = mc^2$", "$E = Fs$"],
                correct: "$E = \\frac{mv^2}{2}$"
            }
        ];

        // --- Logic (Unchanged but ensuring MathJax works) ---
        const questionsList = document.getElementById('questions-list');
        const scoreSpan = document.getElementById('score');
        const percentageP = document.getElementById('percentage');
        const resultsTitle = document.getElementById('results-title');
        const timeSetupDiv = document.getElementById('time-setup');
        const timeInput = document.getElementById('time-input');
        const timerContainer = document.getElementById('timer-container');
        const timerDisplay = document.getElementById('time-left');
        const submitButton = document.getElementById('submit-button');
        const restartButton = document.getElementById('restart-button');
        const resultsDiv = document.getElementById('results');

        let TIME_LIMIT_SECONDS = 2400; // Default 40 min
        let timeLeft = TIME_LIMIT_SECONDS;
        let timerInterval = null;

        function formatTime(s) {
            const m = Math.floor(s / 60);
            const sec = s % 60;
            return `${String(m).padStart(2,'0')}:${String(sec).padStart(2,'0')}`;
        }

        function updateTimerDisplay() {
            timerDisplay.textContent = formatTime(timeLeft);
            if (timeLeft <= 60) {
                timerContainer.classList.remove('bg-red-100', 'border-red-400');
                timerContainer.classList.add('bg-red-500', 'text-white', 'animate-pulse-custom');
                timerContainer.querySelector('p').classList.remove('text-red-700');
                timerContainer.querySelector('p').classList.add('text-white');
            } else {
                timerContainer.classList.remove('bg-red-500', 'text-white', 'animate-pulse-custom');
                timerContainer.classList.add('bg-red-100', 'border-red-400');
                timerContainer.querySelector('p').classList.add('text-red-700');
                timerContainer.querySelector('p').classList.remove('text-white');
            }
        }

        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            timeLeft = TIME_LIMIT_SECONDS;
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitQuiz(true);
                }
            }, 1000);
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function renderQuizStructure() {
            questionsList.innerHTML = '';
            quizData.forEach((data, index) => {
                const qNum = index + 1;
                const div = document.createElement('div');
                div.className = 'question-card bg-white p-6 mb-8 border border-gray-200 rounded-xl shadow-lg';
                div.id = `q-${qNum}`;
                div.innerHTML = `<p class="text-lg font-semibold mb-4 text-gray-800">${data.q}</p><div class="options-container space-y-3" id="options-${qNum}"></div>`;
                
                const container = div.querySelector(`#options-${qNum}`);
                const labels = ['А', 'Б', 'В', 'Г'];
                const shuffled = shuffle([...data.options]);

                shuffled.forEach((txt, i) => {
                    const id = `q${qNum}-opt${i}`;
                    const isCorrect = txt === data.correct;
                    const lbl = document.createElement('label');
                    lbl.htmlFor = id;
                    lbl.className = 'flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-indigo-50 transition duration-150';
                    lbl.innerHTML = `
                        <input type="radio" id="${id}" name="q${qNum}" value="${txt}" class="hidden" data-correct="${isCorrect}">
                        <span class="option-label bg-gray-200 text-gray-600">${labels[i]}</span>
                        <span class="text-base text-gray-700 ml-2">${txt}</span>
                    `;
                    lbl.addEventListener('click', () => {
                        container.querySelectorAll('label').forEach(l => {
                            l.classList.remove('bg-indigo-200', 'border-indigo-500');
                            l.classList.add('border-gray-300');
                        });
                        lbl.classList.remove('border-gray-300');
                        lbl.classList.add('bg-indigo-200', 'border-indigo-500');
                    });
                    container.appendChild(lbl);
                });
                questionsList.appendChild(div);
            });
            if (window.MathJax) MathJax.typesetPromise();
        }

        function startQuiz() {
            const m = parseInt(timeInput.value, 10);
            if (isNaN(m) || m < 5 || m > 180) {
                timeInput.classList.add('border-red-500', 'ring-2', 'ring-red-200');
                setTimeout(() => timeInput.classList.remove('border-red-500', 'ring-2', 'ring-red-200'), 2000);
                return;
            }
            TIME_LIMIT_SECONDS = m * 60;
            timeSetupDiv.classList.add('hidden');
            timerContainer.classList.remove('hidden');
            questionsList.classList.remove('hidden');
            submitButton.classList.remove('hidden');
            renderQuizStructure(); // Render on start to ensure clean state
            startTimer();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function submitQuiz(isTimeout = false) {
            if (timerInterval) clearInterval(timerInterval);
            resultsTitle.textContent = isTimeout ? 'НӘТИЖЕ (Уақыт Аяқталды):' : 'Нәтижелер:';
            
            let score = 0;
            quizData.forEach((data, i) => {
                const qNum = i + 1;
                const card = document.getElementById(`q-${qNum}`);
                const container = document.getElementById(`options-${qNum}`);
                const selected = document.querySelector(`input[name="q${qNum}"]:checked`);
                
                document.querySelectorAll(`input[name="q${qNum}"]`).forEach(inp => inp.disabled = true);
                
                let isCorrect = false;
                if (selected) {
                    const val = selected.value.trim().replace(/[\$\\]/g, '');
                    const cor = data.correct.trim().replace(/[\$\\]/g, '');
                    if (val === cor) { score++; isCorrect = true; }
                }

                container.querySelectorAll('label').forEach(lbl => {
                    const inp = lbl.querySelector('input');
                    lbl.classList.remove('bg-indigo-200', 'border-indigo-500', 'hover:bg-indigo-50');
                    const val = inp.value.trim().replace(/[\$\\]/g, '');
                    const cor = data.correct.trim().replace(/[\$\\]/g, '');
                    const badge = lbl.querySelector('.option-label');
                    badge.classList.remove('bg-gray-200', 'text-gray-600');

                    if (val === cor) {
                        lbl.classList.add('bg-green-100', 'border-green-600', 'font-bold');
                        badge.classList.add('bg-green-600', 'text-white');
                    } else if (inp === selected && !isCorrect) {
                        lbl.classList.add('bg-red-100', 'border-red-600', 'font-bold');
                        badge.classList.add('bg-red-600', 'text-white');
                    } else {
                        lbl.classList.add('bg-gray-50', 'border-gray-200');
                        badge.classList.add('bg-gray-300', 'text-gray-700');
                    }
                });
                card.classList.remove('border-gray-200');
                card.classList.add(isCorrect ? 'border-green-500' : 'border-red-500', 'shadow-xl');
            });

            const pct = ((score / quizData.length) * 100).toFixed(1);
            scoreSpan.textContent = score;
            percentageP.textContent = `Пайыздық көрсеткіш: ${pct}%`;
            percentageP.className = `text-xl font-bold ${pct >= 80 ? 'text-green-600' : pct >= 50 ? 'text-yellow-600' : 'text-red-600'}`;
            
            resultsDiv.classList.remove('hidden');
            submitButton.classList.add('hidden');
            restartButton.classList.remove('hidden');
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function restartQuiz() {
            timeSetupDiv.classList.remove('hidden');
            timerContainer.classList.add('hidden');
            questionsList.classList.add('hidden');
            submitButton.classList.add('hidden');
            restartButton.classList.add('hidden');
            resultsDiv.classList.add('hidden');
            timeInput.value = '40';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
